/* ===============================
   LAYOUT TỔNG (Full Screen)
=================================*/
html, body {
    height: 100%;       /* Bắt buộc: Chiều cao full màn hình */
    margin: 0;
    padding: 0;
    overflow: hidden;   /* Cấm thanh cuộn của trình duyệt (để cuộn riêng từng phần) */
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    background: #f9fafb;
    color: #111827;
}

/* Khung bao ngoài cùng - Chiếm trọn màn hình */
.app-shell {
    height: 100vh;      /* Chiều cao bằng 100% màn hình thiết bị */
    width: 100vw;       /* Chiều rộng bằng 100% màn hình */
    display: flex;      /* Dùng Flexbox để chia cột */
    padding: 0;         /* Xóa padding để sidebar chạm mép */
    box-sizing: border-box;
}

/* Lưới chia cột: Sidebar (cố định) - Main (co giãn) */
.app {
    display: flex;      /* Thay grid bằng flex cho dễ chỉnh full-width */
    width: 100%;
    height: 100%;
    max-width: none;    /* Bỏ giới hạn chiều rộng cũ */
    gap: 0;             /* Bỏ khoảng hở giữa sidebar và main nếu muốn liền mạch */
}

/* ===============================
   SIDEBAR (Cố định bên trái)
=================================*/
.sidebar {
    width: 260px;
    min-width: 260px;
    height: 100%;
    background: #ffffff; /* Nền trắng sạch */
    border-right: 1px solid #f3f4f6; /* Viền mờ tinh tế */
    display: flex;
    flex-direction: column;
    padding: 24px 16px;
    box-sizing: border-box;
    z-index: 50;
    transition: all 0.3s ease;
}

/* 1. Header Logo */
.sidebar-header {
    margin-bottom: 30px;
    padding: 0 8px;
}

/* ============================================================
   SIDEBAR SVG NAV ICONS (Thay thế Emoji cũ)
============================================================ */

/* Style chung cho icon Nav */
.nav-svg {
    width: 24px;
    height: 24px;
    stroke-width: 1.5; /* Độ dày nét vẽ */
    stroke: currentColor; /* Ăn theo màu chữ của nav-item */
    fill: none;
    transition: all 0.3s ease;
}

/* Hiệu ứng khi Hover vào nút */
.nav-item:hover .nav-svg {
    transform: scale(1.1); /* Phóng to nhẹ */
    stroke: #111827; /* Màu đậm hơn khi hover */
}

/* Hiệu ứng khi nút đang Active (Được chọn) */
.nav-item.active .nav-svg {
    stroke: #4f46e5; /* Màu tím chủ đạo */
    stroke-width: 2; /* Nét đậm hơn chút */
    filter: drop-shadow(0 0 3px rgba(79, 70, 229, 0.4)); /* Phát sáng nhẹ */
    transform: translateY(-1px);
}

/* Điều chỉnh lại icon cũ một chút để căn giữa */
.nav-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 28px; /* Cố định chiều rộng khung chứa icon */
    font-size: 18px;
    transition: transform 0.2s;
}
/* ===============================
   PROFILE TAB STYLES
=================================*/

/* 1. Header Card */
.profile-header-card {
    background: #ffffff;
    border-radius: 20px;
    padding: 24px;
    display: flex;
    align-items: center;
    gap: 16px;
    margin-bottom: 16px;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
}
.profile-avatar {
    width: 64px;
    height: 64px;
    border-radius: 50%;
    background: #eef2ff;
    color: #4f46e5;
    font-size: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 2px solid #e0e7ff;
}
.profile-name {
    font-size: 18px;
    font-weight: 700;
    color: #111827;
}
.profile-email {
    font-size: 13px;
    color: #6b7280;
}

/* 2. Stats Grid (Thống kê) */
.stats-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin-bottom: 16px;
}
.stat-box {
    background: #ffffff;
    padding: 16px;
    border-radius: 16px;
    text-align: center;
    box-shadow: 0 2px 4px rgba(0,0,0,0.03);
}
.stat-icon { font-size: 24px; margin-bottom: 4px; }
.stat-val { font-size: 20px; font-weight: 700; color: #111827; }
.stat-label { font-size: 11px; color: #6b7280; text-transform: uppercase; }

/* 3. Settings List (Danh sách cài đặt) */
.settings-list {
    background: #ffffff;
    border-radius: 20px;
    overflow: hidden;
    margin-bottom: 20px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.03);
}
.setting-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 20px;
    border-bottom: 1px solid #f3f4f6;
    cursor: pointer;
    transition: background 0.2s;
}
.setting-item:last-child { border-bottom: none; }
.setting-item:hover { background: #f9fafb; }

.setting-left { display: flex; align-items: center; gap: 12px; }
.setting-icon {
    width: 36px; height: 36px;
    border-radius: 10px;
    display: flex; align-items: center; justify-content: center;
    font-size: 18px;
}
.setting-title { font-size: 14px; font-weight: 600; color: #374151; }
.setting-sub { font-size: 11px; color: #9ca3af; }

/* 4. Logout Button */
.btn-logout-big {
    width: 100%;
    padding: 14px;
    border-radius: 16px;
    border: 1px solid #fee2e2;
    background: #fef2f2;
    color: #b91c1c;
    font-weight: 600;
    cursor: pointer;
    font-size: 14px;
}
.btn-logout-big:hover { background: #fee2e2; }

.logo-box {
    display: flex;
    align-items: center;
    gap: 12px; /* Khoảng cách giữa ảnh logo và chữ */
    padding: 10px 0; /* Khoảng cách trên dưới một chút cho thoáng */
}

.logo-symbol {
    width: 40px;
    height: 40px;
    background: linear-gradient(135deg, #4f46e5, #818cf8);
    color: white;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 800;
    font-size: 18px;
    box-shadow: 0 4px 10px rgba(79, 70, 229, 0.3);
}
.logo-info {
    display: flex;
    flex-direction: column;
    justify-content: center;
}
.logo-block {
    display: flex;
    gap: 10px;
    align-items: center;
    margin-bottom: 12px;
}

.logo-tag {
    font-size: 12px;
    color: #6b7280; /* Màu xám nhạt */
    font-weight: 500;
}

.logo-title {
    font-weight: 800;
    font-size: 18px;
    color: #111827; /* Màu chữ đậm */
    line-height: 1.2;
}
.logo-icon {
    width: 34px;
    height: 34px;
    border-radius: 12px;
    background: #4f46e5;
    color: white;
    display:flex;
    align-items:center;
    justify-content:center;
    font-weight:600;
}
.logo-text-main {
    font-size: 16px;
    font-weight: 600;
}
.logo-text-sub {
    font-size: 12px;
    color: #6b7280;
}

.logo-img {
    width: 45px;  /* Chiều rộng cố định */
    height: 45px; /* Chiều cao cố định */
    object-fit: contain; /* Đảm bảo ảnh không bị méo nếu tỉ lệ không vuông */
    border-radius: 8px; /* Bo góc nhẹ cho mềm mại (xóa dòng này nếu muốn vuông) */
    
    /* Nếu muốn logo tròn vo thì dùng dòng dưới: */
    /* border-radius: 50%; */
}

/* ============================================================
   2. HIỆU ỨNG THÚ CƯNG (NGÀY THƯỜNG)
============================================================ */
.screen-pet {
    position: fixed;
    z-index: 9000 !important;
    pointer-events: none; /* Click xuyên qua */
    user-select: none;
    will-change: transform, left, top;
    -webkit-transform: translateZ(0); /* Kích hoạt GPU */
    -webkit-backface-visibility: hidden;
    will-change: transform, left, top;
    /* Mặc định ẩn để JS định vị xong mới hiện */
    opacity: 0; 
    transition: opacity 0.5s;
}

@keyframes moveHorizontally {
    from { left: -100px; }
    to   { left: 100vw; }
}

/* 2. Đi dọc (Cho cạnh Trái/Phải) */
@keyframes moveVertically {
    from { top: -100px; }
    to   { top: 100vh; }
}

@keyframes floatY {
    0%, 100% { margin-top: 0; }
    50% { margin-top: -20px; }
}

.streak-card {
    background: linear-gradient(135deg, #111827, #1f2937);
    border-radius: 16px;
    padding: 16px;
    display: flex;
    align-items: center;
    gap: 12px;
    color: white;
    box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    transition: transform 0.2s;
}

.streak-card:hover {
    transform: translateY(-2px);
}

.streak-icon-box {
    width: 36px;
    height: 36px;
    background: rgba(255,255,255,0.15);
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
}
.streak-info {
    display: flex;
    flex-direction: column;
}
.streak-label {
    font-size: 10px;
    color: #9ca3af;
    text-transform: uppercase;
}
.streak-number {
    font-size: 14px;
    font-weight: 700;
    color: #fbbf24; /* Màu vàng cam */
}

.streak-pill {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    border-radius: 999px;
    padding: 4px 10px;
    background: #fef3c7;
    font-size: 12px;
    color:#92400e;
    margin-bottom: 12px;
}
.streak-dot {
    width: 8px;
    height: 8px;
    border-radius: 999px;
    background:#f97316;
}

.fire-icon {
    display: inline-block;
    transition: all 0.5s ease; /* Chuyển màu mượt mà */
    font-size: 18px; /* Kích thước cơ bản */
}

/* --- CÁC CẤP ĐỘ LỬA --- */

/* Level 0: Tắt ngúm (Xám, nhỏ, mờ) */
.fire-off .fire-svg { 
    fill: #d1d5db; 
    opacity: 0.5; 
    transform: scale(0.9); /* Thu nhỏ lại */
}

/* Level 1: Nhen nhóm (Vàng cam, kích thước chuẩn) */
.fire-lvl-1 .fire-svg { 
    fill: #f59e0b; 
    transform: scale(1);
    filter: drop-shadow(0 0 2px rgba(245, 158, 11, 0.3)); /* Phát sáng nhẹ */
}

/* Level 2: Bùng cháy (Cam đậm, to hơn, sáng hơn) */
.fire-lvl-2 .fire-svg { 
    fill: #ea580c; 
    transform: scale(1.15); /* Phóng to 15% */
    filter: drop-shadow(0 0 5px rgba(234, 88, 12, 0.6)); /* Phát sáng rõ */
}

/* Level 3: Cực đại (Đỏ rực, rất to, sáng chói lòa, đập thình thịch) */
.fire-lvl-3 .fire-svg { 
    fill: #dc2626; 
    /* Animation mới: Vừa đập vừa thay đổi độ sáng */
    animation: firePulseIntense 1.5s infinite alternate;
}

/* Animation mới cho cấp 3 */
@keyframes firePulseIntense {
    0% { 
        transform: scale(1.25); 
        filter: drop-shadow(0 0 6px rgba(220, 38, 38, 0.7));
    }
    100% { 
        transform: scale(1.4); /* Phóng to lên 40% */
        filter: drop-shadow(0 0 12px rgba(255, 50, 50, 1)); /* Sáng rực */
    }
}

/* ============================================================
   SVG ICONS STYLES (Thay thế Emoji)
============================================================ */

/* Cấu hình chung cho icon SVG */
.medal-svg {
    width: 36px; /* Kích thước to, rõ ràng */
    height: 36px;
    display: block;
    margin: 0 auto;
    filter: drop-shadow(0 4px 6px rgba(0,0,0,0.15)); /* Bóng đổ nhẹ tạo chiều sâu */
    transition: transform 0.2s ease;
}

.lb-row:hover .medal-svg {
    transform: scale(1.1); /* Di chuột vào phóng to nhẹ */
}

/* Hiệu ứng bóng đổ riêng cho từng loại (Tùy chọn) */
.icon-gold { filter: drop-shadow(0 4px 8px rgba(245, 158, 11, 0.4)); }
.icon-silver { filter: drop-shadow(0 4px 8px rgba(148, 163, 184, 0.4)); }
.icon-bronze { filter: drop-shadow(0 4px 8px rgba(234, 88, 12, 0.4)); }

/* Icon Lửa (Streak) */
.fire-svg {
    width: 24px; /* Tăng kích thước cơ bản (cũ là 16px) */
    height: 24px;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* Hiệu ứng nảy nhẹ khi đổi màu */
    vertical-align: middle; /* Căn giữa với số điểm */
}


.app-version {
    text-align: center;
    margin-top: 12px;
    font-size: 10px;
    color: #d1d5db;
}

/* nav */
.nav {
    display: flex;
    flex-direction: column;
    gap: 8px;
    flex-grow: 1; /* Đẩy footer xuống đáy */
}

.nav-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 16px;
    border-radius: 12px;
    border: none;
    background: transparent;
    cursor: pointer;
    transition: all 0.2s ease;
    color: #6b7280;
    font-weight: 500;
    font-size: 14px;
    text-align: left;
}



/* Hover Effect */
.nav-item:hover {
    background: #f9fafb;
    color: #111827;
}
.nav-item:hover .nav-icon {
    transform: scale(1.1);
}

/* Active State */
.nav-item.active {
    background: #eef2ff;
    color: #4f46e5;
    font-weight: 600;
}
/* Thêm thanh chỉ dẫn bên trái cho item đang chọn */
.nav-item.active::before {
    content: "";
    position: absolute;
    left: 16px; /* Căn chỉnh vị trí */
    height: 20px;
    width: 3px;
    background: #4f46e5;
    border-radius: 10px;
    opacity: 0; /* Ẩn đi nếu không thích style này */
}
.nav-button {
    border: none;
    border-radius: 999px;
    padding: 6px 10px;
    display:flex;
    align-items:center;
    gap: 8px;
    background: transparent;
    cursor: pointer;
    font-size: 13px;
}
.nav-button.active {
    background:#e0e7ff;
}
.nav-button .icon {
    font-size: 16px;
}

/* USER STATUS TAGS */
.status-tag {
    flex-shrink: 0; /* Không bao giờ bị co lại */
    font-size: 10px; /* Chữ nhỏ lại xíu cho gọn */
    border-radius: 12px;
    padding: 2px 4px;
    margin-left: 6px;
}
/* 1. Đang hoạt động (Xanh lá) */
.tag-active {
    background: #dcfce7;
    color: #15803d;
    border: 1px solid #86efac;
}

/* 2. Dùng thử (Vàng cam) */
.tag-trial {
    background: #fef3c7;
    color: #b45309;
    border: 1px solid #fcd34d;
}

/* 3. Hết hạn (Đỏ) */
.tag-expired {
    background: #fee2e2;
    color: #b91c1c;
    border: 1px solid #fca5a5;
}

/* goal card */
.goal-card {
    background: #ecfdf5;
    border-radius: 18px;
    padding: 10px 12px;
    font-size: 13px;
    margin-top: 6px;
}
.goal-card h3 {
    font-size: 14px;
    margin: 0 0 4px;
}
.goal-chip-row {
    display:flex;
    flex-wrap:wrap;
    gap:4px;
    margin-top: 6px;
}
.goal-chip {
    border-radius: 999px;
    padding:2px 8px;
    background:#d1fae5;
    font-size:11px;
}

/* sidebar bottom */
.sidebar-bottom {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-top: 12px;
}

.sidebar-footer {
    margin-top: 20px;
}

/* Tùy chỉnh thanh cuộn cho đẹp (Optional) */
.sidebar::-webkit-scrollbar,
.main::-webkit-scrollbar {
    width: 6px;
}
.sidebar::-webkit-scrollbar-thumb,
.main::-webkit-scrollbar-thumb {
    background-color: #d1d5db;
    border-radius: 10px;
}
.account-card {
    background: #fefce8;
    border-radius: 18px;
    padding: 10px 12px;
    border: 1px solid #facc15;
}
.account-label {
    font-size: 12px;
    font-weight: 600;
    color: #92400e;
    margin-bottom: 6px;
}
.user-pill {
    /* Màu sắc và hình dáng */
    background: #f3f4f6;
    border: 1px solid #e5e7eb;
    border-radius: 20px;
    padding: 4px 4px 4px 10px; /* Padding bên phải nhỏ hơn để Tag nằm sát */
    
    font-size: 13px;
    font-weight: 500;
    color: #1f2937;
    cursor: pointer;

    /* QUAN TRỌNG: Flexbox để xếp hàng ngang */
    display: inline-flex;
    align-items: center;
    gap: 6px; /* Khoảng cách giữa các phần tử */

    /* Đảm bảo khung không bao giờ vượt quá chiều rộng màn hình */
    max-width: 100%; 
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}

.user-name-text {
    /* 1. Giới hạn chiều rộng cụ thể cho tên */
    max-width: 110px; /* Tên chỉ được chiếm tối đa 110px */
    
    /* 2. Xử lý cắt chữ */
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    
    /* Căn chỉnh */
    display: block; 
}
.account-actions {
    display:flex;
    flex-direction:column;
    gap:6px;
    margin-top: 8px;
}
.full-width {
    width: 100%;
    justify-content: center;
}

.footer-note {
    font-size: 11px;
    color:#6b7280;
}

/* --- ĐỒNG HỒ TRÔI NỔI (GÓC PHẢI) --- */
.floating-timer-badge {
    position: fixed; /* Ghim cứng vào màn hình */
    top: 20px;       /* Cách mép trên 20px */
    right: 20px;     /* Cách mép phải 20px */
    z-index: 9999;   /* Luôn nằm trên cùng */
    
    background: #ffffff;
    border: 2px solid #f59e0b; /* Viền vàng cam */
    border-radius: 12px;
    padding: 10px 16px;
    
    /* Đổ bóng để tạo cảm giác nổi */
    box-shadow: 0 4px 15px rgba(245, 158, 11, 0.25);
    
    text-align: center;
    min-width: 140px;
    
    /* Hiệu ứng xuất hiện */
    animation: slideInDown 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}
@keyframes slideInDown {
    from { transform: translateY(-100px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
}

.floating-timer-badge.expired {
    border-color: #ef4444;
    box-shadow: 0 4px 15px rgba(239, 68, 68, 0.25);
    background: #fef2f2;
}
.floating-timer-badge.expired .timer-label { color: #b91c1c; }
.floating-timer-badge.expired .timer-value { color: #dc2626; }
.floating-timer-badge.expired .timer-sub { color: #991b1b; }

/* Icon Hết hạn (Vòng tròn gạch chéo) */
.expired-svg {
    width: 16px;
    height: 16px;
    stroke: #ef4444; /* Màu đỏ */
    stroke-width: 2;
    fill: none;
    margin-right: 4px;
    vertical-align: -3px;
}

/* Badge trạng thái Hết hạn */
.badge-expired {
    display: inline-flex;
    align-items: center;
    padding: 4px 10px;
    background: #fef2f2; /* Nền đỏ nhạt */
    color: #b91c1c;       /* Chữ đỏ đậm */
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    border: 1px solid #fecaca;
}

/* Nhãn "DÙNG THỬ" */
.timer-label {
    font-size: 10px;
    font-weight: 800;
    color: #d97706;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 2px;
}

.timer-sub {
    font-size: 9px;
    color: #92400e;
    margin-top: 2px;
}

/* Số giờ đếm ngược */
.timer-value {
    font-size: 20px;
    font-weight: 700;
    color: #b45309;
    font-family: monospace; /* Font kiểu đồng hồ số */
    line-height: 1.2;
}
/* ===============================
   MAIN (Nội dung bên phải - Cuộn độc lập)
=================================*/
.main {
    flex-grow: 1;
    height: 100%;
    overflow-y: auto;
    background: #ffffff;
    
    /* Tăng padding-top lên xíu để bù cho phần header bị mất */
    padding: 30px; 
    box-sizing: border-box;
}
.main-header {
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:12px;
    margin-bottom:12px;
}
.main-title {
    font-size:18px;
    font-weight:600;
}
.main-sub {
    font-size:12px;
    color:#6b7280;
}
.main-header-right {
    display:flex;
    align-items:center;
    gap:8px;
}
.header-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 20px;
    background: #ffffff;
    border-bottom: 1px solid #e5e7eb;
}

.header-right-group {
    display: flex;
    flex-direction: column; /* Xếp chồng lên nhau */
    align-items: flex-end;  /* Căn lề phải thẳng tắp */
    justify-content: center;
    gap: 4px; /* Khoảng cách nhỏ giữa đồng hồ và user */
}
/* buttons */
.btn-primary {
    border:none;
    border-radius:999px;
    padding:8px 14px;
    font-size:13px;
    font-weight:500;
    background:#4f46e5;
    color:white;
    cursor:pointer;
}
.btn-ghost {
    border:none;
    border-radius:999px;
    padding:6px 10px;
    font-size:12px;
    background:#e5e7eb;
    cursor:pointer;
}

/* pill */
.pill {
    border-radius:999px;
    padding:4px 10px;
    background:#e0f2fe;
    display:inline-flex;
    align-items:center;
    gap:6px;
    font-size:12px;
}
.pill-dot {
    width:8px;
    height:8px;
    border-radius:999px;
    background:#0ea5e9;
}

/* ===============================
   CARDS
=================================*/
.card {
    border-radius:18px;
    flex-direction: column;
    border:1px solid #e5e7eb;
    padding:12px 14px;
    margin-bottom:12px;
    background:#ffffff;
}
.card-header-row {
    display: flex;
    justify-content: space-between;
    align-items: center; /* QUAN TRỌNG: Căn giữa nút và chữ */
    margin-bottom: 20px; /* Khoảng cách xuống nội dung bên dưới */
    flex-wrap: wrap;     /* Cho phép xuống dòng trên điện thoại bé */
    gap: 10px;
}
.card-title {
    font-size: 26px;
    font-weight: 900;
    
    /* Tạo màu chuyển sắc cho chữ */
    background: linear-gradient(135deg, #4f46e5 0%, #9333ea 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    
    letter-spacing: -0.5px;
    margin-bottom: 4px;
}
.card-description {
    font-size: 14px;
    color: #6b7280;        /* Màu xám trung tính */
    font-weight: 500;
}
.badge {
    font-size:11px;
    padding:3px 8px;
    border-radius:999px;
    background:#f3e8ff;
    color:#6b21a8;
}


/* 1. Container chính */
.filter-toolbar {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 12px;
    background: #ffffff;
    /* Nếu muốn dính lên trên khi cuộn danh sách thì thêm sticky ở đây */
    flex-shrink: 0;
}

/* 2. Cụm bên trái (Search + Reload) */
.tools-left {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-shrink: 0; /* Cố định, không bị co lại */
}

/* ===============================
   BULK ADD MODAL STYLES
=================================*/

#bulk-modal .modal-card {
    max-height: 90vh;       /* Chiều cao tối đa chỉ bằng 90% màn hình */
    display: flex;          /* Sử dụng Flexbox */
    flex-direction: column; /* Xếp dọc: Header -> Body -> Footer */
    overflow: hidden;       /* Ẩn phần thừa loe ra ngoài bo góc */
}

#bulk-modal .modal-header-modern,
#bulk-modal .modal-footer-modern {
    flex-shrink: 0; /* Cố định kích thước */
}

/* 3. Phần Thân (Body) sẽ chiếm phần còn lại và cuộn độc lập */
#bulk-modal .modal-body-modern {
    flex: 1;              /* Tự động giãn để lấp đầy khoảng trống giữa Header và Footer */
    overflow-y: auto;     /* Bật thanh cuộn dọc cho riêng phần này */
    padding: 20px;        /* Padding bên trong */
    min-height: 0;        /* Fix lỗi flexbox trên một số trình duyệt cũ */
}

/* Tùy chỉnh thanh cuộn cho đẹp hơn */
#bulk-modal .modal-body-modern::-webkit-scrollbar {
    width: 6px;
}
#bulk-modal .modal-body-modern::-webkit-scrollbar-thumb {
    background-color: #cbd5e1;
    border-radius: 4px;
}
.bulk-list-container {
    max-height: 400px;
    overflow-y: auto;
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    background: #f9fafb;
    padding: 10px;
    margin-bottom: 10px;
}

.bulk-item {
    background: white;
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 10px;
    margin-bottom: 8px;
    display: grid;
    grid-template-columns: 1.5fr 1fr 1.5fr 0.5fr; /* Word | IPA | Meaning | Xóa */
    gap: 8px;
    align-items: center;
}

.bulk-input-mini {
    width: 100%;
    padding: 6px;
    border: 1px solid #d1d5db;
    border-radius: 4px;
    font-size: 12px;
}

.btn-remove-item {
    color: #ef4444;
    background: none;
    border: none;
    cursor: pointer;
    font-size: 16px;
    font-weight: bold;
}
.btn-remove-item:hover { color: #b91c1c; }

.inline-svg-icon {
    width: 18px;
    height: 18px;
    stroke-width: 1.8;
    stroke: currentColor; /* Màu ăn theo màu chữ của thẻ cha */
    fill: none;
    vertical-align: -3px; /* Căn chỉnh cho thẳng hàng với chữ */
    display: inline-block;
}

/* Icon mũi tên bên phải thì cách ra một chút */
.icon-right {
    margin-left: 6px;
    width: 16px; /* Nhỏ hơn xíu cho tinh tế */
    height: 16px;
}

/* Hiệu ứng khi hover vào link/nút chứa icon */
a:hover .inline-svg-icon,
button:hover .inline-svg-icon {
    stroke: #4f46e5; /* Đổi màu tím khi di chuột */
    transform: scale(1.1); /* Phóng to nhẹ */
    transition: all 0.2s ease;
}

/* ============================================================
   MODAL MODERN STYLES (Trang trí lại Modal Bulk Add)
============================================================ */

/* 1. Header & Nút Close (X) */
.modal-header-modern {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 24px;
    border-bottom: 1px solid #f3f4f6;
    background: #ffffff;
}

.modal-title-text {
    font-size: 18px;
    font-weight: 700;
    color: #1f2937;
    margin: 0;
}

/* Nút X đẹp, nằm góc phải, không có viền */
.close-icon-btn {
    background: transparent;
    border: none;
    font-size: 28px;
    color: #9ca3af;
    cursor: pointer;
    line-height: 1;
    padding: 0 4px;
    transition: color 0.2s;
}
.close-icon-btn:hover {
    color: #ef4444; /* Hover màu đỏ */
}

/* Step 1 Box (Màu tím nhạt) */
.step-box-1 {
    background: #fdf4ff;
    border: 1px dashed #d946ef; /* Viền nét đứt tím */
    border-radius: 12px;
    padding: 20px;
    text-align: center;
    margin-bottom: 24px;
}
.step-label {
    font-weight: 700;
    color: #a21caf;
    text-transform: uppercase;
    font-size: 12px;
    margin-bottom: 8px;
    letter-spacing: 0.5px;
}
.step-desc {
    font-size: 13px;
    color: #4b5563;
    margin-bottom: 16px;
    line-height: 1.5;
}

.btn-bulk-ai {
    /* Màu nền Gradient (Tím sang Xanh) chuẩn Gemini */
    background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);
    
    /* Chữ trắng đậm */
    color: #ffffff;
    font-weight: 600;
    font-size: 14px;
    
    /* Kích thước & Bo góc */
    padding: 8px 16px;
    border-radius: 20px; /* Bo tròn hình viên thuốc */
    border: none;
    cursor: pointer;
    
    /* Hiệu ứng đổ bóng phát sáng nhẹ */
    box-shadow: 0 4px 10px rgba(168, 85, 247, 0.4);
    
    /* Căn chỉnh icon và chữ */
    display: inline-flex;
    align-items: center;
    gap: 6px;
    
    /* Hiệu ứng mượt mà */
    transition: all 0.3s ease;
}

/* Hiệu ứng khi di chuột vào (Bay lên + Bóng đậm hơn) */
.btn-bulk-ai:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 15px rgba(168, 85, 247, 0.6);
    background: linear-gradient(135deg, #4f46e5 0%, #9333ea 100%);
}

/* Hiệu ứng khi bấm xuống */
.btn-bulk-ai:active {
    transform: translateY(0);
    box-shadow: 0 2px 5px rgba(168, 85, 247, 0.4);
}

/* Icon lấp lánh */
.sparkle-icon {
    font-size: 16px;
    /* Animation lắc nhẹ icon */
    animation: wiggle 2s infinite; 
}

/* Animation lắc nhẹ cho vui mắt */
@keyframes wiggle {
    0%, 100% { transform: rotate(-5deg); }
    50% { transform: rotate(5deg); }
}

/* Nút Mở Gem (Gradient) */
.btn-gemini-link {
    display: inline-block;
    background: linear-gradient(135deg, #d946ef, #8b5cf6);
    color: white;
    padding: 10px 20px;
    border-radius: 8px;
    text-decoration: none;
    font-weight: 600;
    font-size: 14px;
    box-shadow: 0 4px 10px rgba(217, 70, 239, 0.3);
    transition: transform 0.2s;
}
.btn-gemini-link:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 15px rgba(217, 70, 239, 0.4);
}

/* Step 2 Box */
.step-label-dark {
    font-weight: 700;
    color: #374151;
    font-size: 14px;
    margin-bottom: 10px;
}

/* 3. Textarea (Ô nhập liệu xịn) */
.textarea-wrapper {
    position: relative;
}
.modern-textarea {
    width: 100%;
    min-height: 120px;
    padding: 12px;
    border: 1px solid #d1d5db;
    border-radius: 8px;
    font-family: 'Consolas', 'Monaco', monospace; /* Font code */
    font-size: 13px;
    color: #111827;
    background: #f9fafb;
    box-sizing: border-box; /* Quan trọng để không bị tràn lề */
    resize: vertical;
    transition: all 0.2s;
}
.modern-textarea:focus {
    outline: none;
    border-color: #6366f1;
    background: #ffffff;
    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1); /* Hiệu ứng focus ring */
}
/* Dòng trạng thái bên dưới textarea */
.validation-status {
    font-size: 12px;
    margin-top: 6px;
    min-height: 18px; /* Giữ chỗ để không bị giật layout */
    font-weight: 500;
}

/* 4. Footer (Hàng nút bấm cuối) */
.modal-footer-modern {
    padding: 16px 24px;
    background: #f9fafb;
    border-top: 1px solid #f3f4f6;
    display: flex;
    justify-content: flex-end; /* Căn phải */
    gap: 12px; /* Khoảng cách giữa 2 nút */
}

/* Styling cho danh sách xem trước */
.bulk-list-scroll {
    max-height: 300px; /* Giới hạn chiều cao */
    overflow-y: auto;  /* Có thanh cuộn */
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    background: #f9fafb;
}

.bulk-item-row {
    display: flex;
    align-items: center;
    padding: 10px 12px;
    border-bottom: 1px solid #f3f4f6;
    background: #fff;
    gap: 10px;
}
.bulk-item-row:last-child { border-bottom: none; }
.bulk-item-row:hover { background: #fef2f2; } /* Hover màu đỏ nhạt báo hiệu có thể xóa */

.bulk-word-col { flex: 1; font-weight: 600; color: #111827; }
.bulk-mean-col { flex: 1.5; color: #4b5563; font-size: 13px; }
.bulk-ipa-col  { flex: 0.5; color: #6b7280; font-size: 12px; font-family: monospace; }

.btn-delete-mini {
    color: #ef4444;
    cursor: pointer;
    font-size: 16px;
    font-weight: bold;
    padding: 4px;
    background: none;
    border: none;
    opacity: 0.6;
}
.btn-delete-mini:hover { opacity: 1; transform: scale(1.1); }

/* Nút Đóng (Màu xám) */
.btn-ghost-gray {
    background: white;
    border: 1px solid #d1d5db;
    color: #374151;
    padding: 10px 20px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 500;
    font-size: 14px;
    transition: background 0.2s;
}
.btn-ghost-gray:hover {
    background: #f3f4f6;
}

/* Nút Lưu (Màu xanh chủ đạo) */
.btn-primary-save {
    background: #4f46e5;
    color: white;
    border: none;
    padding: 10px 24px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    font-size: 14px;
    box-shadow: 0 2px 5px rgba(79, 70, 229, 0.3);
    transition: background 0.2s, opacity 0.2s;
}
.btn-primary-save:hover {
    background: #4338ca;
}
.btn-primary-save:disabled {
    background: #e5e7eb;
    color: #9ca3af;
    cursor: not-allowed;
    box-shadow: none;
}

/* ===============================
   FORM GRID
=================================*/
.form-grid {
    display:grid;
    grid-template-columns: repeat(2,minmax(0,1fr));
    gap:8px 12px;
}
.form-field label {
    font-size:12px;
    display:block;
    margin-bottom:2px;
}
.form-field input,
.form-field textarea,
.form-field select {
    width:100%;
    box-sizing:border-box;
    padding:6px 8px;
    border-radius:10px;
    border:1px solid #e5e7eb;
    font-size:12px;
    outline:none;
}
.form-field textarea {
    min-height:60px;
}
.ai-btn {
    margin-top:4px;
    font-size:11px;
    padding:4px 8px;
}

/* ===============================
   WORD TABLE
=================================*/
.word-list {
    margin-top:8px;
}

.word-row.word-header {
    position: sticky;
    top: 0;
    background: #f9fafb;
    z-index: 10;
    border-bottom: 2px solid #e5e7eb;
}

#word-list {
    /* Đặt chiều cao tối thiểu khoảng 60% màn hình */
    /* Giúp khung không bị co lại khi ít từ, nút phân trang không bị nhảy lên */
    min-height: 60vh; 
    
    display: flex;
    flex-direction: column;
    justify-content: flex-start; /* Luôn bắt đầu từ trên cùng */
    gap: 0; /* Khoảng cách do word-row tự xử lý */
}
.word-row {
    display: grid;
    /* Cấu trúc mới: Word | IPA | Meaning | Sentence | Type | Folder | Actions */
    grid-template-columns: 1.1fr 0.8fr 1.2fr 1.8fr 0.6fr 0.8fr 0.7fr;
    gap: 6px;
    padding: 4px 0;
    font-size: 12px;
    align-items: center;
    min-height: 45px; 

}
.word-header {
    font-weight:600;
    border-bottom:1px solid #e5e7eb;
    margin-bottom:4px;
}
.word-empty {
    font-size:12px;
    color:#6b7280;
    margin-top:8px;
}

/* folder filter */
.folder-filter-row {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-bottom: 8px;
}

.folder-pill {
    border: none;
    border-radius: 999px;
    padding: 15px 10px;
    font-size: 12px;
    background: #e5e7eb;
    color: #374151;
    cursor: pointer;
}

.folder-pill.active {
    background: #4f46e5;
    color: #ffffff;
}

/* tags */
.tag-level {
    border-radius:999px;
    padding:2px 6px;
    font-size:11px;
}
.tag-A1 { background:#dbeafe; color:#1d4ed8; }
.tag-A2 { background:#dcfce7; color:#166534; }
.tag-B1 { background:#fee2e2; color:#b91c1c; }
.tag-B2 { background:#fef3c7; color:#92400e; }
.tag-C1 { background:#fce7f3; color:#9d174d; }
.tag-other { background:#e5e7eb; color:#374151; }

/* status */
.status-pill {
    border-radius:999px;
    padding:2px 6px;
    font-size:11px;
}
.status-new      { background:#eff6ff; color:#1d4ed8; }
.status-learning { background:#ecfdf5; color:#15803d; }
.status-review   { background:#fef3c7; color:#92400e; }
.status-mastered { background:#f3e8ff; color:#6b21a8; }

/* actions */
.word-actions {
    display:flex;
    gap:4px;
    flex-wrap:wrap;
}
.mini-btn {
    border:none;
    border-radius:999px;
    padding:2px 6px;
    font-size:11px;
    cursor:pointer;
    background:#e5e7eb;
}
.mini-btn.voice { background:#e0f2fe; }
.mini-btn.edit { background:#dbeafe; color:#1d4ed8; }
.mini-btn.delete { background:#fee2e2; color:#b91c1c; }

/* ===============================
   MODAL (đổi mật khẩu + gemini)
=================================*/
.modal-backdrop {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(4px); /* Làm mờ nền phía sau */
    display: flex; justify-content: center; align-items: center;
    z-index: 999999 !important;
}

.modal-card-premium {
    background: #ffffff;
    width: 420px; /* Rộng hơn chút để chứa 2 gói */
    max-width: 90%;
    border-radius: 16px;
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    overflow: hidden;
    position: relative;
    font-family: 'Segoe UI', sans-serif;
    animation: slideIn 0.3s ease-out;
}

.premium-svg {
    width: 50px;
    height: 50px;
    stroke-width: 1.8;
    fill: none;
    display: inline-block;
    vertical-align: middle;
}

/* Màu đỏ cho trạng thái Hết hạn (Nổi bật) */
.icon-expired {
    stroke: #ef4444; /* Màu đỏ */
    filter: drop-shadow(0 2px 4px rgba(239, 68, 68, 0.2)); /* Bóng nhẹ */
}


.premium-header {
    background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
    padding: 20px;
    text-align: center;
    border-bottom: 1px solid #fecaca;
}
.premium-icon { font-size: 40px; display: block; margin-bottom: 5px; animation: pulse 2s infinite; }
.premium-title { color: #b91c1c; font-size: 20px; font-weight: 700; margin: 0; }
.premium-sub { color: #ef4444; font-size: 13px; margin-top: 5px; font-weight: 500; }
.modal-card {
    width: 340px;
    max-width: 95vw;
    background: #ffffff;
    border-radius: 20px;
    padding: 18px 18px 14px;
    box-shadow: 0 20px 45px rgba(15, 23, 42, 0.35);
    border: 1px solid rgba(209, 213, 219, 0.95);
}
.modal-title {
    font-size: 16px;
    font-weight: 600;
    margin-bottom: 4px;
}
.modal-sub {
    font-size: 12px;
    color: #6b7280;
    margin-bottom: 10px;
}
.modal-form {
    display: flex;
    flex-direction: column;
    gap: 8px;
}
.modal-actions {
    display: flex;
    justify-content: flex-end;
    gap: 8px;
    margin-top: 6px;
}
.modal-message {
    font-size: 12px;
    margin-top: 4px;
}
.modal-message.error { color: #b91c1c; }
.modal-message.success { color: #15803d; }

/* ===============================
   LOGIN PAGE
=================================*/
.login-body {
    background: #eef2ff;
    /* Đảm bảo body đủ cao để chứa nội dung */
    min-height: 100vh; 
}
.login-wrapper {
    /* Cho phép chiều cao tự động giãn theo nội dung */
    min-height: 100vh; 
    width: 100%;
    
    display: flex;
    flex-direction: column; /* QUAN TRỌNG: Xếp dọc thay vì ngang */
    align-items: center;    /* Căn giữa theo chiều ngang */
    
    /* Bỏ justify-content: center để không ép vào giữa màn hình nếu nội dung dài */
    /* justify-content: center; <-- XÓA DÒNG NÀY HOẶC ĐỂ NÓ LÀ flex-start */
    justify-content: flex-start; 
    
    padding: 40px 20px;     /* Tạo khoảng cách an toàn với mép màn hình */
    box-sizing: border-box;
}
/* Chỉnh lại Login Card để nó luôn có khoảng cách với nội dung bên dưới */
.login-card {
    background: white;
    border-radius: 24px;
    padding: 30px 22px; /* Tăng padding chút cho thoáng */
    box-shadow: 0 20px 40px rgba(15,23,42,0.1); /* Giảm bóng một chút cho nhẹ */
    width: 360px; /* Tăng chiều rộng lên chút cho đẹp */
    max-width: 100%;
    
    /* Đẩy login card xuống một chút cho cân đối màn hình */
    margin-top: 40px; 
    margin-bottom: 40px; /* Cách phần Landing page bên dưới */
    
    flex-shrink: 0; /* Đảm bảo card không bị co lại khi màn hình bé */
}

/* Trang trí phần Landing Page (SEO Content) cho đẹp hơn */
.seo-content {
    width: 100%;
    max-width: 900px; /* Giới hạn chiều rộng để dễ đọc */
    animation: fadeIn 0.8s ease-out;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}
.login-logo {
    display:flex;
    align-items:center;
    gap:10px;
    margin-bottom:12px;
}
.login-form label {
    font-size:12px;
    display:block;
    margin-bottom:2px;
}
.login-form input {
    width:100%;
    box-sizing:border-box;
    padding:6px 8px;
    border-radius:10px;
    border:1px solid #e5e7eb;
    font-size:12px;
    margin-bottom:6px;
}
.login-message {
    font-size:12px;
    margin-top:4px;
}

/* ===============================
   AI POPUP (spinner)
=================================*/
.ai-card {
    background: white;
    padding: 18px 20px;
    width: 300px;
    border-radius: 20px;
    box-shadow: 0 20px 40px rgba(0,0,0,0.25);
    animation: aiScaleIn 0.22s ease-out;
}
.ai-title {
    font-size: 14px;
    font-weight: 600;
}
.ai-body {
    margin-top: 10px;
    display: flex;
    gap: 12px;
    align-items: center;
}
.ai-spinner {
    width: 32px;
    height: 32px;
    border-radius: 999px;
    border: 3px solid #e5e7eb;
    border-top-color: #4f46e5;
    animation: aiSpin 0.7s linear infinite;
}
.ai-word-label {
    font-size: 13px;
    font-weight: 600;
}
.ai-text {
    font-size: 12px;
    color: #6b7280;
}

@keyframes aiSpin { to { transform: rotate(360deg); } }
@keyframes aiScaleIn {
    from { transform: scale(0.9); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
}

/* ===============================
   TOAST GÓC PHẢI
=================================*/
#toast {
    position: fixed;
    right: 20px;
    bottom: 24px;
    background: #111827;
    color: white;
    padding: 8px 16px;
    border-radius: 12px;
    font-size: 13px;
    opacity: 0;
    pointer-events: none;
    z-index: 99999;
    box-shadow: 0 10px 25px rgba(15,23,42,0.35);
    max-width: 260px;
}
#toast.success { background: #15803d; }
#toast.error   { background: #b91c1c; }
#toast.info    { background: #2563eb; }

#toast.show {
    animation: toastSlideIn 0.25s forwards;
}

@keyframes slideIn {
    from { transform: translateY(20px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
}

/* Toast Loading (Góc PHẢI dưới) */
#toast-loading {
    position: fixed;
    right: 20px;  /* <--- SỬA THÀNH RIGHT */
    bottom: 24px;
    
    background: #ffffff;
    color: #374151;
    padding: 10px 16px;
    border-radius: 12px;
    font-size: 13px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.15);
    border: 1px solid #e5e7eb;
    display: flex;
    align-items: center;
    gap: 10px;
    z-index: 99999;
    
    /* Hiệu ứng trượt lên */
    transform: translateY(100px);
    opacity: 0;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

#toast-loading.show {
    transform: translateY(0);
    opacity: 1;
}

/* Spinner nhỏ quay tròn */
.mini-spinner {
    width: 16px;
    height: 16px;
    border: 2px solid #e5e7eb;
    border-top-color: #4f46e5;
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }


.pagination {
    /* Tạo khoảng cách an toàn phía trên */
    margin-top: auto; /* Kỹ thuật Flexbox: Tự động đẩy xuống đáy cùng */
    
    padding-top: 16px;
    padding-bottom: 4px;
    border-top: 1px solid #e5e7eb;
    background: #ffffff;
    
    /* (Tùy chọn) Nếu muốn nó dính chặt xuống đáy màn hình khi cuộn:
       position: sticky;
       bottom: 0;
       z-index: 10;
    */
    display: flex;
    align-items: center;
    justify-content: flex-end; /* Căn phải như cũ */
    gap: 12px;
}

.page-info {
    color: #6b7280;
}

.page-btn {
    border: none;
    border-radius: 999px;
    padding: 4px 8px;
    font-size: 12px;
    background: #e5e7eb;
    cursor: pointer;
}

.page-btn:disabled {
    opacity: 0.4;
    cursor: default;
}
@keyframes toastSlideIn {
    from { opacity: 0; transform: translateX(16px); }
    to   { opacity: 1; transform: translateX(0); }
}
/* ===============================
   REVIEW SECTION
=================================*/
.review-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 16px;
    margin-top: 16px;
}

.review-svg {
    width: 32px;
    height: 32px;
    stroke-width: 1.5;
    fill: none;
    transition: all 0.3s ease;
}

.review-option-card {
    border: 1px solid #e5e7eb;
    border-radius: 16px;
    padding: 20px;
    display: flex;
    gap: 16px;
    cursor: pointer;
    transition: all 0.2s;
    background: #f9fafb;
}
.review-option-card:hover {
    background: #ffffff;
    box-shadow: 0 10px 25px rgba(0,0,0,0.08);
    border-color: #4f46e5;
    transform: translateY(-2px);
}

.review-option-card:hover .review-svg {
    transform: scale(1.1) rotate(-5deg);
}
.review-icon {
    /* Reset lại style cũ của bạn */
    width: 60px;
    height: 60px;
    border-radius: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0; /* Ẩn text/emoji cũ nếu còn sót */
}
.review-info h3 {
    margin: 0 0 4px;
    font-size: 16px;
    color: #111827;
}
.review-info p {
    margin: 0;
    font-size: 12px;
    color: #6b7280;
    line-height: 1.4;
}

/* 1. Flashcards (Màu Tím) */
.ri-purple {
    background: #f3e8ff; /* Nền tím nhạt */
    color: #9333ea;      /* Icon tím đậm */
}

/* 2. Điền từ (Màu Xanh Dương) */
.ri-blue {
    background: #eff6ff;
    color: #2563eb;
}

/* 3. Sắp xếp chữ (Màu Cam) */
.ri-orange {
    background: #fff7ed;
    color: #ea580c;
}

/* ============================================================
   INLINE SVG ICONS (Cho nút bấm & Input)
============================================================ */

/* Class chung cho icon nhỏ đi kèm chữ */
.icon-svg-sm {
    width: 18px;
    height: 18px;
    stroke-width: 2;
    stroke: currentColor;
    fill: none;
    display: inline-block;
    vertical-align: -3px; /* Căn chỉnh với dòng chữ */
    margin-right: 4px;
}

/* Tinh chỉnh riêng cho icon Tìm kiếm */
.search-icon svg {
    width: 16px;
    height: 16px;
    stroke: #9ca3af; /* Màu xám placeholder */
    transition: stroke 0.2s;
}

/* Khi focus vào ô tìm kiếm thì icon đổi màu tím */
.search-wrapper:focus-within .search-icon svg {
    stroke: #6366f1;
}

/* Hiệu ứng xoay nhẹ cho icon Sparkle (Thêm từ nhanh) */
.btn-bulk-ai:hover .icon-svg-sm {
    animation: spinSparkle 2s linear infinite;
}

@keyframes spinSparkle {
    0% { transform: rotate(0deg) scale(1); }
    50% { transform: rotate(180deg) scale(1.2); }
    100% { transform: rotate(360deg) scale(1); }
}



/* FLASHCARD STYLES */
.flashcard-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-top: 20px;
}
.flashcard-scene {
    width: 320px;
    height: 220px;
    perspective: 1000px;
}
.flashcard {
    width: 100%;
    height: 100%;
    position: relative;
    transition: transform 0.6s;
    transform-style: preserve-3d;
    cursor: pointer;
}
.flashcard.is-flipped {
    transform: rotateY(180deg);
}
.flashcard-face {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    border-radius: 20px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 20px;
    box-sizing: border-box;
    text-align: center;
    border: 1px solid #e5e7eb;
}
.flashcard-front {
    background: #ffffff;
    color: #111827;
}
.flashcard-back {
    background: #f0fdf4; /* xanh nhạt */
    color: #166534;
    transform: rotateY(180deg);
}
.tap-hint {
    margin-top: 12px;
    font-size: 10px;
    color: #9ca3af;
    text-transform: uppercase;
    letter-spacing: 1px;
}
.review-controls {
    display: flex;
    align-items: center;
    gap: 16px;
    margin-top: 20px;
}

/* ===============================
   FIX LỖI BỐ CỤC GAME ĐIỀN TỪ
=================================*/

.fill-game-container {
    /* Dùng Flexbox để căn giữa dọc/ngang nội dung */
    display: flex;
    flex-direction: column;
    align-items: center; 
    
    width: 100%;            /* Chiếm toàn bộ chiều ngang của thẻ cha */
    max-width: 420px;       /* Giới hạn độ rộng chuẩn mobile */
    margin: 0 auto;         /* Căn giữa container */
    padding: 10px;          /* Khoảng cách an toàn 2 bên */
    box-sizing: border-box; /* Quan trọng */
}

/* Ép tất cả các thành phần con phải rộng bằng nhau */
.fill-hint-box,
.btn-check-fill {
    width: 100%;
    box-sizing: border-box; /* Tính cả padding/border vào width -> Chống lệch */
}

/* --- Style cũ giữ nguyên nhưng thêm box-sizing --- */
.fill-hint-box {
    background: #f8fafc;
    border-radius: 16px;
    padding: 20px 15px;
    margin-bottom: 25px;
    border: 1px dashed #cbd5e1;
    text-align: center;
}

.fill-input-wrapper {
    position: relative;
    margin-bottom: 20px;
}

.fill-input {
    width: 100%;            /* Rộng 100% của wrapper */
    padding: 16px;
    font-size: 20px;
    font-weight: 700;
    text-align: center;
    color: #4f46e5;
    background: #ffffff;
    border: 2px solid #e2e8f0;
    border-radius: 14px;
    outline: none;
    transition: all 0.3s ease;
    box-sizing: border-box; /* QUAN TRỌNG NHẤT: Khắc phục lỗi input bị thò ra */
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
}

.fill-input:focus {
    border-color: #6366f1;
    box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
    transform: translateY(-2px);
}

/* Các trạng thái đúng/sai */
.fill-input.correct {
    border-color: #10b981 !important;
    background-color: #ecfdf5 !important;
    color: #047857 !important;
}

.fill-input.wrong {
    border-color: #ef4444 !important;
    background-color: #fef2f2 !important;
    color: #b91c1c !important;
    animation: shake 0.4s ease-in-out;
}

.btn-check-fill {
    width: 100%;
    padding: 14px;
    border-radius: 12px;
    background: #4f46e5;
    color: white;
    font-weight: 600;
    font-size: 16px;
    border: none;
    cursor: pointer;
    box-shadow: 0 4px 6px -1px rgba(79, 70, 229, 0.3);
    transition: transform 0.1s;
}

.btn-check-fill:active {
    transform: scale(0.98);
}

@keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-6px); }
    75% { transform: translateX(6px); }
}


.question-box {
    background: #eff6ff;
    padding: 16px;
    border-radius: 12px;
    margin-bottom: 16px;
    text-align: center;
}
.q-text {
    font-size: 18px;
    font-weight: 600;
    margin-top: 4px;
    color: #1e3a8a;
}
.q-label {
    font-size: 11px;
    color: #6b7280;
    text-transform: uppercase;
}
.answer-box {
    display: flex;
    gap: 8px;
}
.feedback-msg {
    margin-top: 12px;
    text-align: center;
    font-size: 14px;
    min-height: 20px;
}
.feedback-msg.correct { color: #16a34a; font-weight: 600; }
.feedback-msg.wrong { color: #dc2626; font-weight: 600; }

/* GAME SẮP XẾP (SCRAMBLE) */
.scramble-game-container {
    text-align: center;
    padding: 10px;
    max-width: 400px;
    margin: 0 auto;
}
/* Khu vực chứa các ô trống (Slots) */
.scramble-slots {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-bottom: 30px;
    flex-wrap: wrap; /* Xuống dòng nếu từ quá dài */
}

/* Ô chữ cái (Slot) */
.scramble-slot {
    width: 45px;
    height: 45px;
    border: 2px dashed #cbd5e1; /* Nét đứt khi chưa có chữ */
    border-radius: 12px;
    
    display: flex;
    align-items: center;
    justify-content: center;
    
    font-size: 20px;
    font-weight: 700;
    color: #374151;
    background: #f8fafc;
    cursor: pointer;
    transition: all 0.2s;
    user-select: none;
}

.scramble-slot.filled {
    border-style: solid;
    background: #ffffff;
    box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
}

.scramble-slot.correct {
    background-color: #dcfce7 !important; /* Xanh lá nhạt */
    border-color: #16a34a !important;
    color: #166534 !important;
}

.scramble-slot.wrong {
    background-color: #fee2e2 !important; /* Đỏ nhạt */
    border-color: #ef4444 !important;
    color: #b91c1c !important;
    animation: shake 0.3s;
}

/* Vùng chứa các ô chữ nguồn */
.scramble-pool {
    display: flex;
    justify-content: center;
    gap: 10px;
    flex-wrap: wrap;
    margin-top: 20px;
}
.pool-btn {
    width: 40px;
    height: 40px;
    border-radius: 10px;
    background: #e0e7ff;
    color: #4338ca;
    font-weight: 600;
    font-size: 18px;
    border: none;
    cursor: pointer;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    transition: transform 0.1s;
}

.pool-btn:active { transform: scale(0.95); }

/* Khi nút đã được chọn thì mờ đi và không bấm được nữa */
.pool-btn.used {
    opacity: 0.2;
    pointer-events: none;
    transform: scale(0.9);
}

/* Ô chữ cái */
.letter-tile {
    width: 36px;
    height: 36px;
    background: #ffffff;
    border: 1px solid #9ca3af;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 18px;
    color: #374151;
    cursor: pointer;
    box-shadow: 0 2px 0 #9ca3af;
    user-select: none;
    transition: transform 0.1s;
}

.letter-tile:active {
    transform: translateY(2px);
    box-shadow: none;
}

/* Trạng thái đã chọn (ẩn đi ở pool) */
.letter-tile.used {
    opacity: 0;
    pointer-events: none;
}

/* Màu khi đúng/sai */
.scramble-slots.correct { border-color: #22c55e; background: #f0fdf4; }
.scramble-slots.wrong { border-color: #ef4444; background: #fef2f2; }
/* Auth switch link */
.auth-switch {
    margin-top: 12px;
    font-size: 12px;
    text-align: center;
    color: #6b7280;
}
.auth-switch a {
    color: #4f46e5;
    text-decoration: none;
    font-weight: 600;
}
.auth-switch a:hover {
    text-decoration: underline;
}

/* ===============================
   PAYMENT INFO BOX (Thông tin chuyển khoản)
=================================*/
.payment-box {
    background: #f8fafc;
    border: 1px dashed #cbd5e1;
    border-radius: 12px;
    padding: 16px;
    margin: 16px 0;
    text-align: left;
}

.price-tag {
    font-size: 24px;
    font-weight: 700;
    color: #059669; /* Màu xanh lá tiền tệ */
    text-align: center;
    margin-bottom: 12px;
    display: block;
}

.bank-info {
    font-size: 13px;
    color: #334155;
    line-height: 1.6;
}

.bank-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 4px;
    border-bottom: 1px solid #e2e8f0;
    padding-bottom: 4px;
}
.bank-label { color: #64748b; }
.bank-value { font-weight: 600; color: #0f172a; text-align: right; }

.transfer-syntax {
    background: #e0f2fe;
    color: #0369a1;
    padding: 8px;
    border-radius: 8px;
    font-weight: 600;
    text-align: center;
    font-family: monospace;
    font-size: 14px;
    margin-top: 10px;
    border: 1px solid #bae6fd;
}
.contact-admin {
    font-size: 12px;
    color: #6b7280;
    margin-top: 12px;
    font-style: italic;
}

/* Legal Note (Cảnh báo/Lưu ý) */
.legal-note {
    font-size: 11px;
    color: #64748b;
    margin-top: 12px;
    padding-top: 10px;
    border-top: 1px dashed #cbd5e1; /* Đường gạch ngang phân cách */
    text-align: justify;
    line-height: 1.4;
    font-style: italic;
    background: #f1f5f9;
    padding: 8px;
    border-radius: 6px;
}


/* Hiệu ứng hiện modal mượt mà */
#celebration-modal.show {
    animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

@keyframes popIn {
    from { opacity: 0; transform: scale(0.8); }
    to { opacity: 1; transform: scale(1); }
}

/* Đồng hồ đếm ngược dùng thử */
.trial-timer {
    font-size: 11px; /* Chữ nhỏ lại cho đỡ chật */
    font-weight: 700;
    color: #b45309; 
    background: #fffbeb; 
    padding: 2px 8px; /* Padding mỏng lại */
    border-radius: 6px; /* Bo góc nhẹ */
    border: 1px solid #fcd34d;
    white-space: nowrap; /* Không cho xuống dòng */
    
    /* Hiệu ứng hiện ra mượt mà */
    transition: all 0.3s;
}

/* Hiệu ứng nhấp nháy nhẹ gây chú ý */
@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.02); }
    100% { transform: scale(1); }
}

/* Pricing Options */
.pricing-container {
    padding: 20px;
    display: flex;
    gap: 12px;
}

.plan-box {
    flex: 1;
    border: 1px solid #e2e8f0;
    border-radius: 12px;
    padding: 15px 10px;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s;
    position: relative;
    background: #f8fafc;
}

.plan-box:hover { transform: translateY(-3px); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }

/* Gói thường */
.plan-month { border-color: #cbd5e1; }
.plan-month .plan-name { color: #64748b; font-size: 13px; font-weight: 600; }
.plan-month .plan-price { color: #334155; font-size: 18px; font-weight: 700; margin-top: 5px; }

/* Gói VIP */
.plan-lifetime {
    border: 2px solid #f59e0b;
    background: linear-gradient(to bottom right, #fffbeb, #fff);
}

/* Bank Info */
.payment-details { padding: 0 20px 20px 20px; }
.bank-card {
    background: #f1f5f9;
    border-radius: 10px;
    padding: 15px;
    border: 1px dashed #cbd5e1;
}
.bank-row { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 13px; }
.bank-row:last-child { margin-bottom: 0; }
.bank-label { color: #64748b; }
.bank-val { font-weight: 600; color: #1e293b; text-align: right; }
.copy-syntax {
    background: #e2e8f0; padding: 8px; border-radius: 6px;
    text-align: center; font-family: monospace; font-weight: bold; color: #334155;
    margin-top: 10px; font-size: 14px; border: 1px solid #cbd5e1;
    user-select: all; /* Cho phép bôi đen nhanh */
}
.modal-footer { padding: 15px 20px; background: #f8fafc; border-top: 1px solid #e2e8f0; text-align: center; }
.legal-text { font-size: 10px; color: #94a3b8; line-height: 1.4; margin-bottom: 15px; display: block; text-align: justify; }
.btn-logout {
    background: #dc2626; color: white; border: none; padding: 10px 20px;
    border-radius: 8px; font-weight: 600; cursor: pointer; width: 100%;
    transition: background 0.2s;
}
.btn-logout:hover { background: #b91c1c; }
.close-btn { position: absolute; top: 10px; right: 10px; background: none; border: none; font-size: 20px; color: #ef4444; cursor: pointer; opacity: 0.7; }
.close-btn:hover { opacity: 1; transform: scale(1.1); }
.badge-best {
    position: absolute; top: -10px; left: 50%; transform: translateX(-50%);
    background: #f59e0b; color: white; font-size: 10px; font-weight: bold;
    padding: 2px 8px; border-radius: 10px; white-space: nowrap;
}
.plan-lifetime .plan-name { color: #d97706; font-size: 13px; font-weight: 700; text-transform: uppercase; }
.plan-lifetime .plan-price { color: #b45309; font-size: 20px; font-weight: 800; margin-top: 5px; }
.plan-lifetime .plan-desc { font-size: 11px; color: #d97706; margin-top: 2px; }

/* Khi hết giờ thì đổi màu đỏ */
.trial-timer.expired {
    background: #fee2e2;
    color: #b91c1c;
    border-color: #ef4444;
    animation: none;
}

/* ===============================
   IRREGULAR VERBS SEARCH (Giao diện tra cứu)
=================================*/
.irregular-search-box {
    text-align: center;
    padding: 30px 0 20px;
}
.search-title {
    font-size: 22px;
    font-weight: 700;
    color: #4f46e5;
    margin-bottom: 6px;
}
.search-sub {
    font-size: 13px;
    color: #6b7280;
    margin-bottom: 20px;
}
.search-input-wrapper {
    display: flex;
    justify-content: center;
    gap: 8px;
    max-width: 400px;
    margin: 0 auto;
}

/* ============================================================
   MAIN SEARCH BAR STYLES
============================================================ */

.search-wrapper.compact {
    width: 180px; /* Độ rộng cố định vừa phải */
    height: 38px;
    background: #f9fafb;
    border: 1px solid #e5e7eb;
    border-radius: 99px;
    display: flex;
    align-items: center;
    padding: 0 10px;
    transition: all 0.2s;
}

.search-wrapper {
    position: relative;
    display: flex;
    align-items: center;
    background: #f3f4f6; /* Nền xám nhạt */
    border: 1px solid #e5e7eb;
    border-radius: 99px; /* Bo tròn viên thuốc */
    padding: 0 12px;
    width: 220px; /* Độ rộng mặc định */
    height: 36px;
    transition: all 0.2s ease;
}

.search-wrapper.compact input {
    font-size: 13px;
    width: 100%;
    border: none;
    background: transparent;
    outline: none;
}

/* Container chứa các folder */
.folder-scroll-row {
    flex-grow: 1; /* Chiếm hết khoảng trống còn lại bên phải */
    display: flex;
    align-items: center;
    gap: 8px;
    
    /* QUAN TRỌNG: Cho phép cuộn ngang */
    overflow-x: auto; 
    overflow-y: hidden;
    
    /* Đảm bảo nội dung không bị rớt dòng */
    white-space: nowrap;
    
    /* Padding dưới để thanh cuộn không dính sát nút */
    padding-bottom: 4px; 
    
    /* Khắc phục lỗi flexbox trên một số trình duyệt */
    min-width: 0; 
}
.folder-scroll-row::-webkit-scrollbar {
    height: 6px; /* Chiều cao của thanh cuộn ngang */
    display: block; /* BẮT BUỘC: Hiện thanh cuộn */
}

.folder-scroll-row::-webkit-scrollbar-track {
    background: #f1f1f1; 
    border-radius: 4px;
}

.folder-scroll-row::-webkit-scrollbar-thumb {
    background: #c1c1c1; 
    border-radius: 4px;
    transition: background 0.2s;
}

.folder-scroll-row::-webkit-scrollbar-thumb:hover {
    background: #a8a8a8; 
}

.mini-btn.icon-only {
    width: 38px;
    height: 38px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
    background: #f3f4f6;
    border: 1px solid #e5e7eb;
}
.mini-btn.icon-only:hover {
    background: #e5e7eb;
    transform: rotate(180deg);
}

.search-wrapper.compact:focus-within {
    width: 220px; /* Dãn ra khi gõ */
    background: #fff;
    border-color: #6366f1;
    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
}

/* Hiệu ứng khi bấm vào tìm kiếm */
.search-wrapper:focus-within {
    background: #ffffff;
    border-color: #6366f1; /* Viền tím khi active */
    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
    width: 260px; /* Dài ra một chút cho đẹp */
}

.search-icon {
    font-size: 14px;
    color: #9ca3af;
    margin-right: 8px;
    pointer-events: none; /* Không cho bấm vào icon */
}

.clear-icon {
    background: none;
    border: none;
    color: #9ca3af;
    font-size: 18px;
    cursor: pointer;
    padding: 0 0 0 8px;
    line-height: 1;
    display: flex;
    align-items: center;
}
.clear-icon:hover {
    color: #ef4444;
}

#search-input {
    border: none;
    background: transparent;
    outline: none;
    font-size: 13px;
    color: #1f2937;
    width: 100%;
    padding: 0;
}
#irregular-search-input {
    width: 100%;
    padding: 10px 16px;
    border-radius: 99px;
    border: 2px solid #e0e7ff;
    font-size: 15px;
    outline: none;
    transition: all 0.2s;
}
#irregular-search-input:focus {
    border-color: #4f46e5;
    box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
}
.search-btn {
    padding: 0 20px;
    border-radius: 99px;
    font-size: 18px;
}

/* KẾT QUẢ TRA CỨU (CARD) */
.irregular-result-area {
    max-width: 500px;
    margin: 0 auto;
    padding-top: 20px;
}

.verb-detail-card {
    background: #ffffff;
    border: 1px solid #e5e7eb;
    border-radius: 20px;
    padding: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.05);
    text-align: center;
    animation: slideUp 0.3s ease-out;
    margin-bottom: 16px;
}

.verb-meaning {
    font-size: 18px;
    font-weight: 600;
    color: #1f2937;
    margin-bottom: 20px;
    border-bottom: 1px dashed #e5e7eb;
    padding-bottom: 12px;
}

.verb-forms-row {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 12px;
}

.verb-col {
    display: flex;
    flex-direction: column;
    gap: 4px;
}
.verb-label {
    font-size: 11px;
    text-transform: uppercase;
    color: #6b7280;
    font-weight: 600;
}
.verb-word {
    font-size: 16px;
    font-weight: 700;
    padding: 8px 4px;
    border-radius: 8px;
}

/* Màu sắc từng cột */
.v1-style { background: #eef2ff; color: #4338ca; }
.v2-style { background: #fef2f2; color: #b91c1c; }
.v3-style { background: #ecfdf5; color: #047857; }

@keyframes slideUp {
    from { opacity:0; transform: translateY(10px); }
    to { opacity:1; transform: translateY(0); }
}


/* --- NHÃN TỪ MỚI (NEW) --- */
.badge-new {
    display: inline-block;
    background: linear-gradient(135deg, #ff4d4d, #f9cb28);
    color: white;
    font-size: 9px;
    font-weight: 800;
    padding: 2px 6px;
    border-radius: 4px;
    margin-left: 6px;
    text-transform: uppercase;
    box-shadow: 0 2px 5px rgba(255, 77, 77, 0.4);
    
    /* Hiệu ứng nhịp đập */
    animation: newPulse 1.5s infinite;
}

@keyframes newPulse {
    0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 77, 77, 0.7); }
    70% { transform: scale(1.05); box-shadow: 0 0 0 4px rgba(255, 77, 77, 0); }
    100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 77, 77, 0); }
}

/* --- SRS POPUP STYLES --- */
.srs-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 0;
    border-bottom: 1px dashed #e5e7eb;
}
.srs-item:last-child {
    border-bottom: none;
}
.srs-word {
    font-weight: 700;
    color: #1f2937;
    font-size: 14px;
}
.srs-meaning {
    color: #6b7280;
    font-size: 13px;
}
.srs-date {
    font-size: 10px;
    background: #e0e7ff;
    color: #4338ca;
    padding: 2px 6px;
    border-radius: 4px;
}

/* ===============================
   LESSON TAB STYLES
=================================*/
.lesson-grid {
    display: flex;
    flex-direction: column;
    gap: 16px;
    padding-bottom: 40px;
}

.lesson-card {
    background: #ffffff;
    border: 1px solid #e5e7eb;
    border-radius: 16px;
    padding: 20px;
    position: relative;
    transition: all 0.2s ease;
    cursor: pointer;
    box-shadow: 0 2px 5px rgba(0,0,0,0.02);
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.lesson-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.08);
    border-color: #4f46e5;
}

/* Hiệu ứng viền xanh đậm cho bài đang học (HIỆN TẠI) */
.lesson-card.active-course {
    border: 2px solid #3b82f6;
    background: #eff6ff;
}

.course-svg {
    width: 28px;
    height: 28px;
    stroke: white; /* Icon màu trắng để nổi trên nền màu */
    fill: none;
    transition: transform 0.3s ease;
}

/* Hiệu ứng khi di chuột vào thẻ khóa học */
.course-card:hover .course-svg {
    transform: scale(1.15) rotate(-5deg); /* Phóng to và xoay nhẹ */
}

/* --- BADGES (Nhãn NEW / HIỆN TẠI) --- */
.lesson-badge {
    position: absolute;
    top: -10px;
    left: 10px;
    font-size: 10px;
    font-weight: 700;
    color: white;
    padding: 4px 8px;
    border-radius: 6px;
    text-transform: uppercase;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.badge-current { background: #2563eb; } /* Xanh dương */
.badge-new { background: #f97316; }     /* Cam */

/* --- HEADER CARD --- */
.lesson-header {
    display: flex;
    align-items: center;
    gap: 16px;
}

.lesson-icon-box {
    width: 48px;
    height: 48px;
    border-radius: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 15px;
    transition: all 0.3s ease;
    flex-shrink: 0; /* Không bị co lại trên mobile */
}

.lesson-svg {
    width: 24px;
    height: 24px;
    stroke-width: 1.5;
    fill: none;
    stroke: currentColor;
}

.l-active {
    background: #eef2ff;
    color: #4f46e5;
    border: 1px solid #c7d2fe;
}

/* 2. Đã hoàn thành (Màu Xanh lá) */
.l-completed {
    background: #f0fdf4;
    color: #16a34a;
    border: 1px solid #bbf7d0;
}

/* 3. Bị khóa (Màu Xám) */
.l-locked {
    background: #f3f4f6;
    color: #9ca3af;
    border: 1px solid #e5e7eb;
}

/* Hiệu ứng hover vào thẻ bài học */
.lesson-card:hover .lesson-icon-box.l-active {
    transform: scale(1.1) rotate(-5deg);
    background: #4f46e5;
    color: white;
}

/* Các màu nền icon khác nhau */
.bg-blue {
    background: linear-gradient(135deg, #3b82f6, #2563eb); /* Gradient xanh */
    box-shadow: 0 4px 10px rgba(37, 99, 235, 0.3);
    color: white;
    /* Căn giữa icon */
    display: flex; align-items: center; justify-content: center;
    width: 50px; height: 50px; border-radius: 14px; /* Kích thước hộp icon */
}

/* Nền Cam (Cho Idiom) */
.bg-orange {
    background: linear-gradient(135deg, #f97316, #ea580c); /* Gradient cam */
    box-shadow: 0 4px 10px rgba(234, 88, 12, 0.3);
    color: white;
    display: flex; align-items: center; justify-content: center;
    width: 50px; height: 50px; border-radius: 14px;
}
.bg-green  { background: #dcfce7; color: #16a34a; }
.bg-purple { background: #f3e8ff; color: #9333ea; }

.lesson-info {
    flex: 1;
}
.lesson-title {
    font-size: 16px;
    font-weight: 700;
    color: #1f2937;
    margin: 0 0 4px 0;
}
.lesson-desc {
    font-size: 13px;
    color: #6b7280;
    margin: 0;
}

/* --- PROGRESS BAR --- */
.lesson-progress-wrapper {
    margin-top: 4px;
}
.progress-track {
    width: 100%;
    height: 8px;
    background: #e5e7eb;
    border-radius: 99px;
    overflow: hidden;
    position: relative;
}
.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #60a5fa, #3b82f6);
    border-radius: 99px;
    transition: width 0.5s ease;
}

.progress-stats {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 6px;
    font-size: 12px;
    color: #6b7280;
    font-weight: 500;
}
.trophy-icon {
    color: #3b82f6;
    font-size: 16px;
}


/* ===============================
   TOPIC LIST STYLES (LEVEL 2)
=================================*/

/* Header của màn hình Topic */
.topic-view-header {
    background: #ffffff;
    border-radius: 16px;
    padding: 16px 20px;
    margin-bottom: 20px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.03);
    border: 1px solid #e5e7eb;
}
.header-top-row {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    margin-bottom: 12px;
}
.header-top-row:hover h3 { color: #3b82f6; }

.header-progress-row {
    display: flex;
    align-items: center;
    gap: 10px;
}

/* Grid chứa các Topic */
.topic-grid {
    display: flex;
    flex-direction: column;
    gap: 12px;
    padding-bottom: 40px;
}

/* Thẻ Topic (Pill Style) */
.topic-item {
    background: #ffffff;
    border: 1px solid #e5e7eb;
    border-radius: 24px; /* Bo tròn nhiều hơn */
    padding: 12px 20px;
    display: flex;
    flex-direction: column; /* Xếp dọc: Nội dung trên, Progress dưới */
    gap: 8px;
    cursor: pointer;
    transition: all 0.2s;
    box-shadow: 0 2px 4px rgba(0,0,0,0.02);
}

.topic-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.05);
    border-color: #93c5fd;
}

.topic-content {
    display: flex;
    align-items: center;
    gap: 16px;
}

.topic-icon {
    width: 42px;
    height: 42px;
    border-radius: 50%; /* Tròn vo */
    background: #eff6ff;
    border: 2px solid #dbeafe;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    flex-shrink: 0;
}

.topic-name {
    font-size: 14px;
    font-weight: 600;
    color: #374151;
    flex: 1;
}

/* Thanh tiến độ nhỏ bên dưới mỗi topic */
.topic-progress-track {
    width: 100%;
    height: 6px;
    background: #f3f4f6;
    border-radius: 99px;
    overflow: hidden;
    margin-left: 58px; /* Thụt vào thẳng hàng với chữ */
    width: calc(100% - 58px);
}
.topic-progress-fill {
    height: 100%;
    background: #60a5fa;
    border-radius: 99px;
}

/* ===============================
   TOPIC SUMMARY STYLES
=================================*/
.summary-list-scroll {
    max-height: 400px;
    overflow-y: auto;
    border: 1px solid #e5e7eb;
    border-radius: 12px;
}

.summary-item {
    display: flex;
    align-items: center;
    padding: 12px 16px;
    border-bottom: 1px solid #f3f4f6;
    background: #ffffff;
    transition: background 0.2s;
    cursor: pointer;
}
.summary-item:last-child { border-bottom: none; }
.summary-item:hover { background: #f9fafb; }

/* Custom Checkbox */
.summary-checkbox {
    width: 20px;
    height: 20px;
    margin-right: 16px;
    accent-color: #4f46e5; /* Màu tím chủ đạo */
    cursor: pointer;
}

.summary-content { flex: 1; }
.summary-word {
    font-size: 15px;
    font-weight: 700;
    color: #1f2937;
}
.summary-mean {
    font-size: 13px;
    color: #6b7280;
}

/* Từ đã được lưu trước đó thì làm mờ đi */
.summary-item.already-saved {
    opacity: 0.6;
    background: #f0fdf4; /* Xanh nhạt */
}
.summary-item.already-saved .summary-word::after {
    content: " (Đã có trong sổ)";
    font-size: 10px;
    color: #16a34a;
    font-weight: normal;
    margin-left: 6px;
}

/* Style cho thẻ từ vựng nhảy */
.jumping-card {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    
    background: #ffffff;
    border: 2px solid #d946ef;
    border-radius: 16px;
    padding: 15px 25px;
    text-align: center;
    box-shadow: 0 10px 25px rgba(217, 70, 239, 0.4);
    
    /* Hiệu ứng di chuyển mượt */
    transition: top 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275), 
                left 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275),
                transform 0.3s;
    
    cursor: pointer;
    min-width: 120px;
    z-index: 10;
}

.jumping-card:active {
    transform: translate(-50%, -50%) scale(0.95);
}

.jump-text {
    font-size: 24px;
    font-weight: 800;
    color: #4f46e5;
    margin-bottom: 4px;
}

.jump-mean {
    font-size: 14px;
    color: #6b7280;
    font-weight: 500;
}



/* ============================================================
   RANKING LAYOUT (FULL SCREEN - NO BODY SCROLL)
============================================================ */

/* 1. Khung chính: Cố định chiều cao, không cho cuộn trang */
#ranking-section {
    height: calc(100vh - 65px) !important; /* Trừ thanh menu đáy */
    overflow: hidden; 
    padding-bottom: 0 !important; /* Xóa padding thừa */
    display: flex;
    flex-direction: column;
}

.ranking-layout {
    display: flex;
    gap: 15px;
    height: 100%;
    align-items: stretch;
    padding: 5px;
    box-sizing: border-box;
}

/* --- CỘT TRÁI: BẢNG XẾP HẠNG (Giữ nguyên style cũ nhưng fix cuộn) --- */
.leaderboard-panel {
    flex: 1;
    background: white;
    border-radius: 16px;
    border: 1px solid #e5e7eb;
    box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
    display: flex;
    flex-direction: column;
    overflow: hidden; 
}
.lb-header {
    flex-shrink: 0;
    display: flex;
    padding: 15px 20px;
    background: #f8fafc;
    border-bottom: 1px solid #e2e8f0;
    font-size: 11px; font-weight: 700; color: #64748b;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.lb-col-rank { width: 50px; text-align: center; } /* Cột hạng */
.lb-col-user { flex: 1; text-align: left; padding-left: 10px; } /* Cột tên */
.lb-col-score { width: 80px; text-align: right; } /* Cột điểm */

/* List Scroll */
.lb-list-scroll { flex: 1; overflow-y: auto; }
.lb-row {
    display: flex;
    align-items: center;
    padding: 14px 20px;
    border-bottom: 1px solid #f1f5f9;
    transition: all 0.2s;
    font-size: 14px;
    color: #334155;
}

.lb-row:hover { background: #f8fafc; }

.lb-name-text {
    font-weight: 600;
    font-family: system-ui, -apple-system, sans-serif;
}

/* Top 1: Vàng - Nền sáng - Chữ đậm */
.lb-row.top-1 {
    background: linear-gradient(90deg, #fffbeb 0%, #ffffff 100%);
    border-left: 4px solid #f59e0b; /* Viền vàng */
    padding-left: 16px; /* Bù lại 4px viền */
}
.lb-row.top-1 .lb-col-rank { font-size: 20px; } /* Icon to */
.lb-row.top-1 .lb-name-text { color: #b45309; font-weight: 800; font-size: 15px; }
.lb-row.top-1 .lb-col-score { color: #d97706; font-weight: 800; }

/* Top 2: Bạc/Xám */
.lb-row.top-2 {
    background: linear-gradient(90deg, #f8fafc 0%, #ffffff 100%);
    border-left: 4px solid #94a3b8; /* Viền bạc */
    padding-left: 16px;
}
.lb-row.top-2 .lb-col-rank { font-size: 18px; }
.lb-row.top-2 .lb-name-text { color: #475569; font-weight: 700; }

/* Top 3: Đồng/Cam */
.lb-row.top-3 {
    background: linear-gradient(90deg, #fff7ed 0%, #ffffff 100%);
    border-left: 4px solid #fdba74; /* Viền đồng */
    padding-left: 16px;
}
.lb-row.top-3 .lb-col-rank { font-size: 18px; }
.lb-row.top-3 .lb-name-text { color: #9a3412; font-weight: 700; }

/* Các hạng thường */
.lb-rank-num {
    font-weight: 700;
    color: #94a3b8;
    background: #f1f5f9;
    width: 24px; height: 24px;
    border-radius: 6px;
    display: inline-flex;
    align-items: center; justify-content: center;
    font-size: 12px;
}

.lb-my-rank {
    flex-shrink: 0;
    border-top: 1px solid #e5e7eb;
    background: #ffffff;
    padding: 12px 20px;
    display: flex; 
    align-items: center;
    box-shadow: 0 -4px 20px rgba(0,0,0,0.05);
    z-index: 20;
    transition: all 0.3s ease;
    position: relative;
}

/* Hiệu ứng khi lọt Top */
.lb-my-rank.is-top-1 {
    background: linear-gradient(90deg, #fffbeb, #fff);
    border-left: 4px solid #f59e0b;
    box-shadow: 0 -4px 20px rgba(245, 158, 11, 0.15);
}
.lb-my-rank.is-top-2 {
    background: linear-gradient(90deg, #f8fafc, #fff);
    border-left: 4px solid #94a3b8;
}
.lb-my-rank.is-top-3 {
    background: linear-gradient(90deg, #fff7ed, #fff);
    border-left: 4px solid #fdba74;
}

.my-rank-badge {
    width: 32px; 
    height: 32px;
    background: #4f46e5; 
    color: white;
    border-radius: 8px;
    display: flex; align-items: center; justify-content: center;
    font-weight: 700; font-size: 14px;
    box-shadow: 0 2px 5px rgba(79, 70, 229, 0.3);
}

/* Nếu top 1, 2, 3 thì đổi màu badge */
.is-top-1 .my-rank-badge { background: #f59e0b; box-shadow: 0 2px 8px rgba(245, 158, 11, 0.4); }
.is-top-2 .my-rank-badge { background: #64748b; box-shadow: none; }
.is-top-3 .my-rank-badge { background: #ea580c; box-shadow: none; }

/* Tên và Streak */
.my-rank-info { flex: 1; padding-left: 12px; }
.my-name-display { font-weight: 700; color: #1e293b; font-size: 14px; }
.my-rank-status { font-size: 11px; color: #6b7280; }

.my-score-display { 
    font-weight: 800; color: #4f46e5; font-size: 16px; 
    display: flex; align-items: center; gap: 4px;
}
.is-top-1 .my-score-display { color: #d97706; }

.lb-my-rank .lb-name-text { color: #4f46e5; }

/* --- CỘT PHẢI: WIDGETS --- */
.ranking-sidebar {
    width: 320px; /* Chiều rộng cố định */
    display: flex;
    flex-direction: column;
    gap: 12px;
    height: 100%;
}

/* ============================================================
   REFRESH ICON SVG (Cho Widget Chat)
============================================================ */

.refresh-svg {
    width: 18px;
    height: 18px;
    stroke: #94a3b8; /* Màu xám mặc định */
    stroke-width: 2;
    fill: none;
    transition: all 0.4s ease;
}

/* Container của nút refresh */
.refresh-btn-wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    cursor: pointer;
    transition: background 0.2s;
}

/* Hiệu ứng khi di chuột vào */
.refresh-btn-wrapper:hover {
    background: #f1f5f9; /* Nền xám nhạt */
}

.refresh-btn-wrapper:hover .refresh-svg {
    stroke: #4f46e5; /* Đổi màu tím */
    transform: rotate(180deg); /* Xoay 180 độ */
}

/* Hiệu ứng khi bấm (Active) */
.refresh-btn-wrapper:active .refresh-svg {
    transform: rotate(360deg);
}

/* ============================================================
   HEATMAP STYLE (PIXEL PERFECT - GITHUB STYLE)
============================================================ */

.widget-card.heatmap-card {
    background: white;
    border-radius: 16px;
    border: 1px solid #e5e7eb;
    padding: 20px;
    flex-shrink: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    box-shadow: 0 2px 5px rgba(0,0,0,0.02);
}

.heatmap-wrapper {
    display: flex;
    flex-direction: column;
    align-items: flex-start; /* Căn trái toàn bộ khối */
}

/* Dòng chứa Month Labels */
.heatmap-months {
    display: flex;
    position: relative;
    height: 15px; /* Chiều cao cố định cho dòng tháng */
    width: 100%;
    margin-bottom: 4px;
    margin-left: 28px; /* Thụt vào bằng chiều rộng cột Thứ */
}

.heatmap-month-label {
    position: absolute;
    font-size: 10px;
    color: #64748b;
    font-weight: 500;
}

/* Container chính chứa Thứ + Lưới */
.heatmap-body {
    display: flex;
    gap: 4px; /* Khoảng cách giữa cột Thứ và Lưới */
}

/* Cột Thứ (T2, T4, T6) - Dùng Grid để khớp dòng */
.heatmap-days {
    display: grid;
    grid-template-rows: repeat(7, 10px); /* 7 dòng, mỗi dòng 10px bằng ô vuông */
    gap: 3px; /* Gap 3px bằng lưới */
    padding-right: 4px;
}

.heatmap-days span {
    font-size: 9px;
    color: #94a3b8;
    line-height: 10px; /* Căn giữa chiều cao dòng */
    text-align: right;
    visibility: hidden; /* Ẩn các dòng lẻ */
}

/* Chỉ hiện T2, T4, T6 (Dòng 2, 4, 6) */
.heatmap-days span:nth-child(2),
.heatmap-days span:nth-child(4),
.heatmap-days span:nth-child(6) {
    visibility: visible;
}

/* Lưới ô vuông */
.heatmap-grid {
    display: grid;
    grid-template-rows: repeat(7, 10px); 
    grid-auto-flow: column;
    gap: 3px; 
}

/* Ô vuông */
.hm-cell {
    width: 10px;
    height: 10px;
    border-radius: 2px;
    background-color: #f1f5f9; /* Mặc định (0) */
    position: relative;
    box-sizing: border-box; /* Để border không làm to ô */
}

.hm-cell:hover {
    border: 1px solid rgba(0,0,0,0.4);
    z-index: 10;
}

/* BẢNG MÀU INDIGO (Xanh Tím - Tươi sáng hơn) */
.hm-l0 { background-color: #f1f5f9; }
.hm-l1 { background-color: #c7d2fe; } /* 1-2 */
.hm-l2 { background-color: #818cf8; } /* 3-5 */
.hm-l3 { background-color: #4f46e5; } /* 6-9 */
.hm-l4 { background-color: #312e81; } /* 10+ */

/* Chú thích (Legend) */
.heatmap-legend {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    gap: 4px;
    font-size: 10px;
    color: #94a3b8;
    margin-top: 8px;
    width: 100%;
    margin-left: 10px;
}
.sq { width: 10px; height: 10px; border-radius: 2px; display:inline-block; }

/* TOOLTIP TINH CHỈNH (Nhỏ gọn, nằm trên cao) */
.hm-tooltip {
    visibility: hidden;
    background-color: #1e293b;
    color: #fff;
    text-align: center;
    padding: 4px 8px;
    border-radius: 4px;
    
    /* Vị trí */
    position: absolute;
    z-index: 100;
    bottom: 160%; /* Đẩy lên cao hơn nữa để không che ô */
    left: 50%;
    transform: translateX(-50%);
    
    white-space: nowrap;
    font-size: 10px;
    font-weight: 600;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.2s;
}

/* Mũi tên tooltip */
.hm-tooltip::after {
    content: "";
    position: absolute;
    top: 100%;
    left: 50%;
    margin-left: -4px;
    border-width: 4px;
    border-style: solid;
    border-color: #1e293b transparent transparent transparent;
}

.hm-cell:hover .hm-tooltip {
    visibility: visible;
    opacity: 1;
}
/* ============================================================
   CHAT WIDGET STYLES (Admin, Me, User)
============================================================ */

.widget-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px; /* Cách nội dung xa hơn chút cho thoáng */
    
    /* Font chữ nổi bật */
    font-size: 16px !important;
    font-weight: 800 !important;
    color: #111827 !important;
    letter-spacing: -0.3px; /* Dồn chữ nhẹ cho hiện đại */
}

/* Căn chỉnh icon SVG đi kèm tiêu đề */
.widget-header svg {
    margin-right: 8px; /* Khoảng cách giữa icon và chữ */
    stroke-width: 2.5; /* Icon đậm hơn theo chữ */
}

/* Riêng cho phần Chat, nút Refresh vẫn giữ nguyên */
.widget-header .refresh-btn-wrapper {
    margin-left: auto; /* Đẩy sang phải cùng */
}


.widget-card.chat-widget {
    background: white;
    border-radius: 16px;
    border: 1px solid #e5e7eb;
    padding: 12px;
    flex: 1; 
    display: flex;
    flex-direction: column;
    min-height: 0;
    box-shadow: 0 2px 5px rgba(0,0,0,0.02);
}

.chat-content {
    
    overflow-y: auto;
    padding-right: 5px;
    display: flex;
    flex-direction: column;
    gap: 12px;
    border-top: 1px dashed #f3f4f6;
    padding-top: 10px;
}

/* --- BASE ITEM --- */
.chat-item {
    display: flex;
    gap: 8px;
    align-items: flex-start;
    font-size: 13px;
    max-width: 90%;
}

.chat-avatar {
    width: 28px; height: 28px; border-radius: 50%;
    color: white; font-weight: 700; font-size: 11px;
    display: flex; align-items: center; justify-content: center;
    flex-shrink: 0;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.chat-bubble {
    padding: 8px 12px;
    border-radius: 12px;
    position: relative;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}

.chat-name {
    font-size: 11px; font-weight: 700; margin-bottom: 2px;
    display: flex; align-items: center; gap: 6px;
}
.chat-time { font-weight: 400; color: #94a3b8; font-size: 9px; }
.chat-msg { line-height: 1.4; word-wrap: break-word; }

/* --- 1. ADMIN (Nổi bật) --- */
.chat-item.admin {
    max-width: 95%;
}
.chat-item.admin .chat-bubble {
    background: #fef2f2; /* Nền đỏ nhạt */
    border: 1px solid #fecaca;
}
.chat-item.admin .chat-name { color: #b91c1c; }
.chat-item.admin .chat-msg { color: #7f1d1d; font-weight: 500; }

/* Tag Admin */
.admin-tag {
    background: #dc2626; color: white;
    font-size: 8px; padding: 1px 4px; border-radius: 4px;
    font-weight: 800; letter-spacing: 0.5px;
}

/* --- 2. ME (Tin nhắn của mình - Căn phải) --- */
.chat-item.me {
    align-self: flex-end; /* Đẩy sang phải */
    flex-direction: row-reverse; /* Đảo ngược avatar (nếu có hiện) */
}
.chat-item.me .chat-bubble {
    background: #4f46e5; /* Màu tím chủ đạo */
    color: white;
    border-bottom-right-radius: 2px;
    border-top-left-radius: 12px;
}
.chat-item.me .chat-name { 
    color: #e0e7ff; 
    justify-content: flex-end; /* Tên căn phải */
}
.chat-item.me .chat-time { color: #a5b4fc; }
.chat-item.me .chat-msg { color: white; }

/* --- 3. USER KHÁC --- */
.chat-item.user .chat-bubble {
    background: #f1f5f9;
    color: #334155;
    border-top-left-radius: 2px;
}
.chat-item.user .chat-name { color: #1e293b; }

/* Input Area */
.chat-input-area {
    margin-top: 10px;
    flex-shrink: 0;
    display: flex; gap: 8px;
    border-top: 1px solid #e5e7eb;
    padding-top: 10px;
}
.chat-input {
    flex: 1; border: 1px solid #cbd5e1; border-radius: 20px;
    padding: 8px 14px; font-size: 13px; outline: none; background: #f9fafb;
    transition: all 0.2s;
}
.chat-input:focus { background: white; border-color: #4f46e5; box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1); }

.chat-send-btn {
    width: 36px; height: 36px; border-radius: 50%;
    background: #4f46e5; color: white; border: none; cursor: pointer;
    font-size: 14px; display: flex; align-items: center; justify-content: center;
    transition: transform 0.1s;
}
.chat-send-btn:active { transform: scale(0.9); }
/* ============================================================
   GLOBAL LOADER STYLES
============================================================ */
#global-loader {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #ffffff;
    z-index: 1000000 !important;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    transition: opacity 0.5s ease-out, visibility 0.5s;
}

/* Class để ẩn loader khi load xong */
#global-loader.hidden {
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
}

.loader-content {
    text-align: center;
    width: 90%;
    max-width: 400px;
}

.loader-icon {
    font-size: 50px;
    margin-bottom: 10px;
    animation: bounce 1s infinite;
}

.loader-title {
    font-size: 24px;
    font-weight: 800;
    color: #4f46e5;
    margin-bottom: 30px;
    letter-spacing: 1px;
}

/* Khu vực Mẹo */
.tip-container {
    min-height: 80px; /* Giữ chiều cao cố định để không bị giật layout */
    margin-bottom: 20px;
}

.tip-label {
    font-size: 11px;
    font-weight: 700;
    color: #9ca3af;
    margin-bottom: 6px;
    letter-spacing: 1px;
    text-transform: uppercase;
}

.tip-text {
    font-size: 15px;
    color: #374151;
    font-weight: 500;
    line-height: 1.5;
    /* Hiệu ứng chuyển chữ mượt mà */
    transition: opacity 0.5s ease-in-out, transform 0.5s ease;
    opacity: 1;
    transform: translateY(0);
}

/* Class hỗ trợ hiệu ứng đổi chữ */
.tip-text.fade-out {
    opacity: 0;
    transform: translateY(-10px);
}
.tip-text.fade-in {
    opacity: 0; /* Bắt đầu ẩn */
    transform: translateY(10px); /* Bắt đầu từ dưới */
}

/* Thanh Loading */
.progress-container {
    width: 100%;
    height: 6px;
    background: #f3f4f6;
    border-radius: 10px;
    overflow: hidden;
    margin-top: 10px;
}

.progress-bar {
    height: 100%;
    width: 0%; /* JS sẽ tăng cái này */
    background: linear-gradient(90deg, #4f46e5, #a855f7);
    border-radius: 10px;
    transition: width 0.3s ease;
    
    /* Hiệu ứng ánh sáng chạy qua */
    position: relative;
    overflow: hidden;
}

.progress-bar::after {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    background: linear-gradient(
        90deg,
        rgba(255, 255, 255, 0) 0%,
        rgba(255, 255, 255, 0.4) 50%,
        rgba(255, 255, 255, 0) 100%
    );
    transform: translateX(-100%);
    animation: shimmer 1.5s infinite;
}

@keyframes shimmer {
    100% { transform: translateX(100%); }
}

@keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}

/* ============================================================
   PROFILE ICONS (SVG Line Art)
============================================================ */

/* Icon chung trong Profile */
.pro-svg {
    width: 24px;
    height: 24px;
    stroke-width: 1.5;
    fill: none;
    stroke: currentColor;
}

/* Icon Avatar to hơn chút */
.avatar-svg {
    width: 32px;
    height: 32px;
    stroke-width: 1.5;
}

/* Icon trong các mục Cài đặt (Setting items) */
.setting-icon svg {
    width: 20px;
    height: 20px;
    stroke-width: 1.8;
}

/* Icon Đăng xuất */
.logout-svg {
    width: 20px;
    height: 20px;
    margin-right: 8px;
    stroke-width: 2;
}

/* Chỉnh lại Flexbox cho nút Đăng xuất để căn giữa icon */
.btn-logout-big {
    display: flex;
    align-items: center;
    justify-content: center;
}

.profile-section {
    background: #ffffff;
    border-radius: 16px;
    padding: 20px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.05);
    margin-top: 20px;
}

/* Group các mục chọn */
.setting-item {
    margin-bottom: 20px;
}

/* ============================================================
   AUDIO BUTTON (Loa phát âm thanh)
============================================================ */
/* Icon Loa nhỏ trong nút */
.audio-icon-sm {
    width: 20px;
    height: 20px;
    stroke: #4b5563; /* Màu xám đậm */
    transition: all 0.2s ease;
}

/* Định dạng nút tròn bao quanh (nếu soundBtn là nút tròn) */
.btn-audio-circle {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
    background: white;
    border: 1px solid #e5e7eb;
    border-radius: 50%; /* Tròn xoe */
    cursor: pointer;
    transition: all 0.2s;
}

/* Hiệu ứng khi di chuột hoặc bấm */
.btn-audio-circle:hover {
    background: #eef2ff;
    border-color: #4f46e5;
}

.btn-audio-circle:hover .audio-icon-sm {
    stroke: #4f46e5; /* Icon đổi màu tím */
    transform: scale(1.1);
}
.btn-audio {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    background: white;
    border: 1px solid #e5e7eb;
    border-radius: 20px;
    cursor: pointer;
    font-size: 13px;
    font-weight: 600;
    color: #374151;
    transition: all 0.2s ease;
}

.btn-audio:hover {
    border-color: #4f46e5;
    color: #4f46e5;
    background: #eef2ff;
}

/* Icon Loa */
.audio-svg {
    width: 18px;
    height: 18px;
    fill: none;
    stroke: currentColor;
    stroke-width: 1.8;
}

/* Hiệu ứng sóng âm khi hover */
.btn-audio:hover .wave-1 {
    animation: soundWave 1s infinite;
}
.btn-audio:hover .wave-2 {
    animation: soundWave 1s infinite 0.2s; /* Trễ 0.2s */
}

@keyframes soundWave {
    0%, 100% { opacity: 1; stroke-width: 1.8; }
    50% { opacity: 0.5; stroke-width: 1.5; }
}

/* Thiết kế lại Select Box */
#voice-select {
    width: 100%;
    padding: 12px 16px;
    border-radius: 12px;
    border: 2px solid #f1f5f9;
    background-color: #f8fafc;
    font-size: 14px;
    font-weight: 500;
    color: #334155;
    outline: none;
    appearance: none; /* Xóa mũi tên mặc định */
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%2364748b'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 12px center;
    background-size: 16px;
    transition: all 0.2s;
}

/* Các hàng setting */
.voice-row {
    margin-bottom: 20px;
}
.voice-row:last-child { margin-bottom: 0; }
.voice-label {
    font-size: 13px;
    font-weight: 600;
    color: #475569;
    margin-bottom: 8px;
    display: block;
}

.modern-select {
    width: 100%;
    padding: 12px 16px;
    padding-right: 40px; /* Chừa chỗ cho mũi tên */
    font-size: 14px;
    color: #334155;
    background-color: #ffffff;
    border: 1px solid #cbd5e1;
    border-radius: 10px;
    appearance: none; /* Ẩn giao diện mặc định của trình duyệt */
    -webkit-appearance: none;
    outline: none;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 2px 5px rgba(0,0,0,0.03);
}

.modern-select:hover {
    border-color: #94a3b8;
}

.modern-select:focus {
    border-color: #6366f1; /* Màu tím chủ đạo */
    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
}
.voice-config-card {
    background: #f8fafc; /* Màu nền xám xanh rất nhạt */
    border: 1px solid #e2e8f0;
    border-radius: 16px;
    padding: 20px;
    margin-top: 15px;
}
#voice-select:focus {
    border-color: #6366f1;
    background-color: #ffffff;
    box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
}

/* Thiết kế lại Thanh trượt (Slider) */
#voice-speed {
    -webkit-appearance: none;
    width: 100%;
    height: 6px;
    border-radius: 5px;
    background: #e2e8f0;
    outline: none;
    margin: 15px 0;
}

#voice-speed::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    background: #6366f1;
    cursor: pointer;
    border: 3px solid #ffffff;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}

.select-arrow {
    position: absolute;
    right: 14px;
    top: 50%;
    transform: translateY(-50%);
    pointer-events: none;
    color: #64748b;
    font-size: 12px;
}

/* 2. TÙY BIẾN THANH TRƯỢT (Slider) */
.modern-range {
    -webkit-appearance: none;
    width: 100%;
    height: 6px;
    background: #e2e8f0;
    border-radius: 5px;
    outline: none;
    cursor: pointer;
}

/* Cục tròn kéo (Thumb) */
.modern-range::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 20px;
    height: 20px;
    background: #6366f1;
    border-radius: 50%;
    border: 3px solid #ffffff;
    box-shadow: 0 2px 6px rgba(99, 102, 241, 0.4);
    transition: transform 0.1s;
}

.modern-range::-webkit-slider-thumb:hover {
    transform: scale(1.1);
}

/* Nút Test (Nghe thử) */
.btn-test-voice {
    background: #ffffff;
    border: 1px solid #cbd5e1;
    color: #475569;
    padding: 0 16px;
    border-radius: 10px;
    font-weight: 600;
    font-size: 13px;
    cursor: pointer;
    transition: all 0.2s;
    height: 42px; /* Cao bằng thanh Select */
    display: flex; align-items: center; gap: 6px;
}
.btn-test-voice:hover {
    background: #f1f5f9;
    color: #0f172a;
    border-color: #94a3b8;
}

/* ============================================================
   SEASONAL EFFECTS (Hiệu ứng theo mùa)
============================================================ */
.seasonal-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none; /* Để bấm xuyên qua, không chặn chuột */
    z-index: 9000 !important;
    overflow: hidden;
}

.falling-item {
    position: absolute;
    top: -50px;
    user-select: none;
    will-change: transform;
    animation-name: seasonalFall;
    animation-timing-function: linear;
    animation-fill-mode: forwards;
}

/* Hiệu ứng rung lắc nhẹ khi rơi cho tự nhiên */
@keyframes seasonalFall {
    0% {
        transform: translateY(0) rotate(0deg) translateX(0);
        opacity: 1;
    }
    100% {
        transform: translateY(110vh) rotate(360deg) translateX(20px);
        opacity: 0;
    }
}

/* ============================================================
   CHAT SKELETON LOADING (Hiệu ứng khung xương)
============================================================ */

/* Khung bao ngoài giống chat-item */
.chat-skeleton {
    display: flex;
    gap: 8px;
    align-items: flex-end; /* Hoặc flex-start tùy thiết kế */
    margin-bottom: 15px;
    padding-left: 5px;
}

/* Avatar giả */
.sk-avatar {
    width: 28px; 
    height: 28px; 
    border-radius: 50%;
    background: #f3f4f6;
    flex-shrink: 0;
}

/* Bong bóng chat giả */
.sk-bubble {
    height: 36px;
    background: #f3f4f6;
    border-radius: 12px;
    border-bottom-left-radius: 2px;
    width: 60%; /* Độ dài ngẫu nhiên */
}

/* Class tạo hiệu ứng ánh sáng chạy (Shimmer) */
.skeleton-anim {
    position: relative;
    overflow: hidden;
}

.skeleton-anim::after {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(
        90deg, 
        rgba(255,255,255,0) 0%, 
        rgba(255,255,255,0.6) 50%, 
        rgba(255,255,255,0) 100%
    );
    transform: translateX(-100%);
    animation: sk-shimmer 1.5s infinite;
}

@keyframes sk-shimmer {
    100% { transform: translateX(100%); }
}

/* Đảo ngược cho tin nhắn của "Me" (nếu muốn làm giả cả 2 bên) */
.chat-skeleton.right {
    flex-direction: row-reverse;
}
.chat-skeleton.right .sk-bubble {
    border-bottom-left-radius: 12px;
    border-bottom-right-radius: 2px;
}

/* ============================================================
   LEADERBOARD SKELETON (Khung xương Bảng xếp hạng)
============================================================ */

.lb-skeleton-row {
    display: flex;
    align-items: center;
    padding: 14px 20px;
    border-bottom: 1px solid #f1f5f9;
}

/* Các khối giả lập */
.sk-rank-box {
    width: 24px; height: 24px; 
    border-radius: 6px; 
    background: #f3f4f6;
}

.sk-user-info {
    display: flex; 
    align-items: center; 
    gap: 12px;
    width: 100%;
}

.sk-lb-avatar { /* Giả lập Avatar nếu có, hoặc khoảng trống */
    width: 0px; /* Nếu style mới bỏ avatar thì để 0, nếu muốn hiện thì set 36px */
    height: 36px;
    border-radius: 50%;
    background: #f3f4f6;
}

.sk-lb-name {
    height: 14px;
    width: 60%; /* Độ dài ngẫu nhiên */
    background: #f3f4f6; 
    border-radius: 4px;
}

.sk-lb-score {
    width: 40px; 
    height: 14px; 
    background: #f3f4f6; 
    border-radius: 4px;
    margin-left: auto; /* Đẩy sang phải */
}



/* ===============================
   RESPONSIVE
=================================*/
@media (max-width: 840px) {
    .app {
        grid-template-columns: 1fr;
        display: block;
        height: auto;
    }
}

@media (max-width: 480px) { 
    /* Trên điện thoại, tên phải ngắn hơn nữa */
    .user-name-text {
        max-width: 90px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    
    .user-pill {
        font-size: 12px;
        padding: 4px 8px;
    }
    
    .status-tag {
        font-size: 9px;
        padding: 2px 6px;
    }

    .flashcard-scene {
        width: 100%;
        max-width: 340px;
        aspect-ratio: 4/3; /* Tỉ lệ chữ nhật đẹp hơn trên mobile */
        height: auto;
    }

    .login-wrapper { padding: 15px; }
    .login-card { width: 100%; margin-top: 10px; }

    .lesson-header { gap: 10px; }
    .lesson-icon-box { width: 45px; height: 45px; font-size: 22px; }
    .lesson-title { font-size: 16px; }
    .lesson-desc { font-size: 12px; }
    
    /* Input Game điền từ */
    .fill-input {
        font-size: 20px !important;
        padding: 12px;
    }

}
@media (max-width: 768px) {
    
   /* Trả lại quyền cuộn cho body trên mobile */
    html, body {
        overflow: auto; /* Cho phép cuộn trang bình thường */
        height: auto;
    }
    .app-shell {
        display: block;
        padding: 0;
        height: auto;
    }
    
    .app {
        display: block;
        height: auto;
    }

    .sidebar {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 60px; /* Chiều cao cố định gọn gàng */
        z-index: 10000;
        
        background: rgba(255, 255, 255, 0.98);
        border-top: 1px solid rgba(0,0,0,0.1);
        box-shadow: 0 -4px 10px rgba(0,0,0,0.03);
        
        padding: 0;
        padding-bottom: env(safe-area-inset-bottom); /* Fix cho iPhone tai thỏ */
        
        display: flex;
        justify-content: center;
        align-items: center;
    }

    

    /* Ẩn bớt các phần rườm rà trên Mobile cho gọn */
    .goal-card, 
    .footer-note,
    .logo-text-sub { 
        display: none; 
    }

    .sidebar-header, 
    .sidebar-footer {
        display: none !important; /* Ẩn Logo và Footer trên Mobile */
    }
    
   .sidebar .logo-block,
    .sidebar .streak-pill,
    .sidebar .goal-card,
    .sidebar .sidebar-bottom, /* Ẩn luôn phần Account Card to đùng */
    .sidebar .footer-note {
        display: none !important;
    }

    .account-card {
        margin-top: 10px;
        padding: 8px;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }
    
    .account-actions {
        flex-direction: row; /* Nút dàn hàng ngang */
        margin-top: 0;
    }
    .full-width {
        width: auto;
    }

    /* 5. TÙY CHỈNH THANH NAV (Các nút bấm) */
    .nav {
        display: flex;
        flex-direction: row;
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
        justify-content: space-between; /* Chia đều khoảng cách */
        gap: 0; /* Không dùng gap cứng, để flex tự chia */
    }


    .nav-button {
        flex-direction: column; /* Icon nằm trên, Chữ nằm dưới */
        gap: 4px;
        padding: 0;
        background: transparent !important; /* Bỏ màu nền xám */
        border: none;
        width: 100%; /* Vùng bấm rộng ra */
        height: 100%;
        
        color: #9ca3af; /* Màu xám mặc định */
        font-size: 10px;
        font-weight: 500;
    }

    .nav-item {
        flex: 1; /* Chia đều chiều rộng (20% mỗi nút nếu có 5 nút) */
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        
        padding: 0;
        margin: 0;
        background: transparent !important; /* Xóa nền xám mặc định */
        border-radius: 0;
        height: 100%;
        color: #9ca3af;
        min-width: 0; /* Cho phép co nhỏ nếu màn hình quá bé */
    }

    .nav-item i, 
    .nav-icon {
        font-size: 20px;
        margin-bottom: 4px;
        display: block;
        line-height: 1;
    }

    .nav-item span {
        font-size: 12px; /* Chữ nhỏ gọn */
        font-weight: 500;
        text-align: center;
        display: block;
        width: 100%;
        line-height: 1.1;
        
        /* Xử lý chữ dài (như Động từ BQT) */
        white-space: nowrap; 
        overflow: hidden;
        text-overflow: ellipsis;
        padding: 0 2px;
    }

    .nav-item.active {
        color: #4f46e5; /* Màu tím xanh chủ đạo */
        background: transparent !important;
        font-weight: 800;
    }

    .nav-item.active i,
    .nav-item.active .nav-icon {
        transform: translateY(-2px); /* Nhảy nhẹ lên khi active */
        transition: transform 0.2s;
    }

    /* 7. Xóa thanh gạch dọc bên trái của giao diện Desktop */
    .nav-item.active::before {
        display: none !important;
    }

    /* 8. Hiệu ứng khi bấm */
    .nav-item:active {
        opacity: 0.7;
        transform: scale(0.95);
    }
    .nav-button .icon {
        font-size: 22px; /* Icon to lên chút */
        margin: 0;
    }
    .nav-button.active {
        color: #4f46e5; /* Màu xanh chủ đạo */
        font-weight: 700;
        background: transparent !important;
    }

    .nav-button:active {
        transform: scale(0.95);
    }

    /* 3. MAIN CONTENT */
   .main {
        padding: 20px 16px 80px 16px; /* Giữ padding bottom 80px để tránh menu che */
    }
    
    .header-row {
        display: none; 
    }
    
    /* Form nhập liệu: Chuyển thành 1 cột */
    .form-grid {
        grid-template-columns: 1fr; 
    }
    .form-field[style*="grid-column: span 2"] {
        grid-column: auto !important; /* Reset các ô span 2 */
    }

    /* 4. BIẾN BẢNG TỪ VỰNG THÀNH DẠNG THẺ (CARD VIEW) - QUAN TRỌNG NHẤT */
    
    /* Ẩn dòng tiêu đề bảng (Word, IPA, Meaning...) */

    .word-header {
        display: none; 
    }

    /* Biến mỗi hàng thành 1 cái thẻ */
    .word-row {
        display: flex;
        flex-direction: column; /* Xếp dọc các thông tin */
        align-items: flex-start;
        
        background: #ffffff;
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        padding: 12px;
        margin-bottom: 10px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.03);
        
        position: relative;
    }

    /* --- TÙY CHỈNH TỪNG PHẦN TỬ TRONG THẺ --- */
    
    /* 1. Word (Từ vựng) - To và Đậm */
    .word-row > div:nth-child(1) {
        font-size: 16px;
        font-weight: 700;
        color: #4f46e5;
        margin-bottom: 4px;
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: space-between; /* Đẩy badge NEW sang phải nếu muốn */
    }

    /* 2. IPA - Màu xám, nhỏ */
    .word-row > div:nth-child(2) {
        font-size: 13px;
        color: #6b7280;
        font-family: monospace;
        margin-bottom: 8px;
    }
    
    /* Giả lập nhãn cho IPA (Optional) */
    .word-row > div:nth-child(2):before {
        content: "IPA: ";
        font-weight: 600;
        color: #9ca3af;
    }

    /* 3. Meaning (Nghĩa) - To rõ */
    .word-row > div:nth-child(3) {
        font-size: 15px;
        font-weight: 500;
        color: #111827;
        margin-bottom: 6px;
    }

    /* 4. Sentence (Câu ví dụ) - In nghiêng */
    .word-row > div:nth-child(4) {
        font-size: 13px;
        color: #4b5563;
        font-style: italic;
        background: #f9fafb;
        padding: 6px 10px;
        border-radius: 8px;
        width: 100%;
        box-sizing: border-box;
        margin-bottom: 8px;
    }

    /* 5. Type (Loại từ) & 6. Folder - Xếp chung 1 hàng */
    /* Chúng ta dùng order flexbox hoặc display logic nếu muốn ghép dòng */
    
    .word-row > div:nth-child(5) { /* Type */
        display: inline-block;
        margin-bottom: 8px;
    }
    
    .word-row > div:nth-child(6) { /* Folder */
        font-size: 11px;
        color: #6b7280;
        background: #f3f4f6;
        padding: 2px 8px;
        border-radius: 4px;
        display: inline-block;
        margin-bottom: 12px;
    }
    .word-row > div:nth-child(6):before {
        content: " ";
    }

    /* 7. Actions (Nút bấm) - Dàn full chiều ngang */
    .word-actions {
        width: 100%;
        display: flex;
        justify-content: flex-end; /* Căn phải */
        gap: 8px;
        padding-top: 8px;
        border-top: 1px dashed #e5e7eb;
    }

    .mini-btn {
        padding: 6px 14px; /* Nút to hơn cho dễ bấm */
        font-size: 12px;
    }
    
    /* Tối ưu ô tìm kiếm */
    #search-input {
        width: 100%; /* Full màn hình */
        font-size: 14px;
        padding: 10px 14px !important;
    }
    
    /* Ẩn các cột thừa nếu có */
    .word-empty {
        text-align: center;
        padding: 20px;
    }

    .pagination {
        /* Trên mobile, ghim thanh phân trang xuống đáy vùng nội dung */
        position: sticky;
        bottom: 0;
        background: rgba(255, 255, 255, 0.95); /* Nền mờ nhẹ */
        backdrop-filter: blur(4px);
        
        /* Căn giữa cho dễ bấm bằng ngón cái */
        justify-content: center; 
        padding: 12px;
        box-shadow: 0 -2px 10px rgba(0,0,0,0.03);
    }

    .page-btn {
        padding: 8px 16px;
        font-size: 14px;
        background: #f3f4f6;
    }

    .card-header-row {
        gap: 10px;
    }
    .search-wrapper {
        width: 160px; /* Nhỏ lại chút trên mobile */
    }
    .search-wrapper:focus-within {
        width: 180px;
    }

    .search-wrapper.compact {
        width: 100%; /* Search full chiều ngang */
    }

    .filter-toolbar {
        flex-direction: column;
        align-items: stretch; /* Kéo full chiều ngang */
        gap: 12px;
    }

    .tools-left {
        width: 100%;
    }
/* 1. CONTAINER CHÍNH: Cuộn toàn trang tự nhiên */
    #ranking-section {
        display: flex;
        flex-direction: column;
        gap: 30px; /* Khoảng cách rộng rãi giữa các khối */
        
        /* --- BUNG LỤA --- */
        height: auto !important; 
        min-height: 100vh;
        overflow-y: visible !important; /* Dùng cuộn của trình duyệt */
        
        /* Padding đáy lớn để Menu dưới không che nội dung cuối */
        padding: 15px 15px 150px 15px !important; 
        background: #f9fafb !important;
    }

    .ranking-layout {
        display: contents;
    }

    /* 2. HEATMAP (Biểu đồ) */
    .ranking-sidebar {
        order: 1; 
        width: 100% !important;
        flex: none;
    }
    .widget-card.heatmap-card {
        
        width: 100%;
        display: block;
        padding-bottom: 10px;
    }

    /* 3. BẢNG XẾP HẠNG (CỐ ĐỊNH 500PX) */
    .leaderboard-panel {
        order: 2;
        width: 100% !important;
        
        height: 500px !important; /* Giới hạn chiều cao */
        
        background: white;
        border-radius: 16px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        display: flex !important;
        flex-direction: column !important;
        overflow: hidden; 
    }

    .lb-header { flex: 0 0 50px; border-bottom: 1px solid #f1f5f9; background: #fff; z-index: 2; }
    .lb-my-rank { flex: 0 0 60px; border-top: 1px solid #f1f5f9; background: #fff; z-index: 5; }

    .lb-body {
        flex: 1;
        overflow-y: auto;
        overscroll-behavior-y: contain; /* Chống trôi trang khi cuộn hết danh sách */
        padding-bottom: 0;
    }

    /* 4. CHAT WIDGET (CỐ ĐỊNH 500PX - CHO GỌN) */
    .widget-card.chat-widget {
        order: 3;
        width: 100% !important;
        margin: 0 !important;
        
        /* --- GIỚI HẠN CHIỀU CAO CHAT --- */
        height: 300px !important; 
        
        display: flex !important;
        flex-direction: column !important;
        background: white;
        border-radius: 16px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        
    }
    
    .chat-content {
    /* 1. Ép chiều cao cứng */
    height: 400px !important; 
    
    /* 2. QUAN TRỌNG: Đổi sang block để tránh lỗi flexbox không cuộn */
    display: block !important; 
    
    /* 3. Ép hiện thanh cuộn (cho dù nội dung ngắn) để test */
    overflow-y: scroll !important; 
    
    overscroll-behavior-y: contain;
    padding: 15px;
    background: #ffffff;
    border: 1px solid #f1f5f9;
}
    
    .chat-input-area {
        flex: 0 0 auto;
        padding: 15px;
        background: white;
        border-top: 1px solid #f1f5f9;
    }
}
